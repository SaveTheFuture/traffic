(function(){if(!window.launchData){var F=YUI.Env.getBase(/^(.*)mim-api\/mim-api([\-min]*)\.js/);if(F.indexOf("?")==0){F=F.substring(1);}window.launchData={phonehomeData:{base_url:F.substring(0,F.indexOf("yim/")),root:"",comboBase:F.substring(0,F.indexOf("yim/"))+"combo.php?"},combine:false,filter:"debug",lang:"en-US",urlParams:{}};}var B=window.launchData,D=B.filter=="min"?true:false,A=["ar-JO","bg-BG","bn-BD","bn-IN","cs-CZ","da-DK","de-AT","de-DE","el-GR","en-GB","en-US","es-AR","es-ES","es-MX","es-US","et-EE","fi-FI","fil-PH","fr-BE","fr-CA","fr-FR","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","id-ID","it-IT","kn-IN","ko-KR","lt-LT","lv-LV","ml-IN","mr-IN","ms-MY","nb-NO","nl-BE","nl-NL","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","sr-Cyrl-RS","sv-SE","ta-IN","te-IN","th-TH","ti-PH","tl-PH","tr-TR","uk-UA","ur-PK","vi-VN","zh-Hans-CN","zh-Hant-HK","zh-Hant-TW"],I=["ar-EG","ar-JO-nokia","ar-JO","ar-MA","ar-SA","bg-BG","bn-BD","bn-IN","cs-CZ","sl-SI","da-DK","de-AT","de-CH","de-DE","el-GR","en-AU","en-CA-rogers","en-CA","en-GB-bt","en-GB","en-IE","en-IN","en-MY","en-NZ","en-PH","en-SG","en-US-ftr","en-US-sbc","en-US-vzn","en-US","en-ZA","es-AR-nokia","es-AR","es-CL-nokia","es-CL","es-CO-nokia","es-CO","es-ES","es-MX-nokia","es-MX","es-PE-nokia","es-PE","es-US-nokia","es-US","es-VE-nokia","es-VE","et-EE","fi-FI","fil-PH","fr-BE","fr-CA-rogers","fr-CA","fr-CH","fr-FR","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","id-ID","it-CH","it-IT","kn-IN","ko-KR-nokia","ko-KR","lt-LT","lv-LV","ml-IN","mr-IN","ms-MY-nokia","ms-MY","nl-BE","nl-NL","no-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU-nokia","ru-RU","sk-SK","sl-SL","sr-Cyrl-RS","sv-SE","ta-IN","te-IN","th-TH","tr-TR","uk-UA","ur-PK-nokia","ur-PK","vi-VN","zh-Hans-CN-nokia","zh-Hans-CN","zh-Hant-HK","zh-Hant-TW"],K=["substitute","yim-intl","conversationarea","commonutils","event-custom","event-key","conversationinput","globalconstants"],G=["mim-acplugin","node-focusmanager","yim-intl"],J;if(B.smsSupported){K.push("conv-plugin-sms");G.push("commonutils-sms");}var C={filter:B.filter,lang:B.lang+",en-US",filters:{},logExclude:{event:true,base:true,attribute:true,augment:true,Selector:true},groups:{yim:{base:B.phonehomeData.base_url+"yim/build/",root:B.phonehomeData.root+"yim/build/",comboBase:B.phonehomeData.comboBase,combine:B.combine,filter:B.filter,lang:B.lang,gallery:"gallery-2010.09.29-18-36",modules:{"globalconfig":{path:D?"p/globalconfig.js":null,requires:["base-base","yim-intl"]},"globalconstants":{path:D?"p/globalconstants.js":null,requires:[]},"mim-dateformat":{path:D?"p/mim-dateformat.js":null,requires:["yim-intl","datatype-date"]},commonutils:{path:D?"p/commonutils.js":null,requires:["globalconfig","yim-intl","globalconstants"]},"commonutils-sms":{path:D?"p/commonutils-sms.js":null,requires:["commonutils"]},"sessionmanager":{path:D?"p/sessionmanager.js":null,requires:["base-base","requestmanager","command","commonutils","events","globalconstants"]},"contactsmanager":{path:D?"p/contactsmanager.js":null,requires:["base-base","mim-dateformat","globalconstants","requestmanager","command","yim-intl","commonutils","events","abutils","sessionmanager"]},"conv-plugin-sms":{path:D?"p/conv-plugin-sms.js":null,requires:["yim-intl","plugin","commonutils","globalconfig"]},"conversationmanager":{path:D?"p/conversationmanager.js":null,requires:["base-base","requestmanager","command","yim-intl","commonutils","events","abutils","globalconstants","conversationapi"]},"requestmanager":{path:D?"p/requestmanager.js":null,requires:["base-base","xframe","events"]},"conversationapi":{path:D?"p/conversationapi.js":null,requires:["base-base","requestmanager","command","commonutils","events"]},"ommenus":{path:D?"p/ommenus.js":null,requires:["commonutils","yim-intl","sessionmanager","events"]},"omapi":{path:D?"p/omapi.js":null,requires:["events","command"]},"delayloader":{path:D?"p/delayloader.js":null,requires:["events","requestmanager","globalconfig"]},command:{path:D?"p/command.js":null,requires:["event"]},"events":{path:D?"p/events.js":null,requires:[]},"contactscoring":{path:D?"p/contactscoring.js":null,requires:["events","globalconfig","contactsmanager","sessionmanager"]},"contactlist":{path:D?"p/contactlist.js":null,requires:["command","contactgroup","yim-intl","base-base","node","contactscoring"],skinnable:true,lang:A},"contactgroup":{path:D?"p/contactgroup.js":null,requires:["node","contact","commonutils","event-custom","yim-intl"],lang:A},contact:{path:D?"p/contact.js":null,requires:["contactsmanager","anim","commonutils","yim-intl","common-ui-intl-bidi","globalconstants"],skinnable:true,lang:A},"xframe":{path:D?"p/xframe.js":null,requires:["json","base-base","node","classnamemanager","substitute"]},ymlutil:{path:D?"p/ymlutil.js":null},"common-ui-intl-bidi":{path:"neo-bidi/common-ui-intl-bidi-min.js"},"value-change-1":{path:D?"p/value-change-1.js":null,requires:["node-base","event-focus"]},"filter-contacts":{path:D?"p/filter-contacts.js":null},"mim-acplugin":{path:D?"p/mim-acplugin.js":null,requires:["commonutils","events","widget","plugin","event","value-change-1","filter-contacts","yim-intl"]},abutils:{path:D?"p/abutils.js":null,requires:["base-base","commonutils"]},conversationinput:{path:D?"p/conversationinput.js":null,requires:["ymlutil","widget","classnamemanager","commonutils","rte","yim-intl","sessionmanager","contactsmanager","conversationapi"],skinnable:true,lang:A},conversationarea:{path:D?"p/conversationarea.js":null,skinnable:true,requires:["node","mim-dateformat","contactsmanager","sessionmanager","yim-intl","common-ui-intl-bidi","ymlutil","globalconstants"],lang:A},conversation:{path:D?"p/conversation.js":null,requires:K,skinnable:true,lang:A},rte:{path:D?"p/rte.js":null,requires:["base","node","substitute","commonutils","common-ui-intl-bidi","yim-intl","richselect"],skinnable:true,lang:A},richselect:{path:D?"p/richselect.js":null,requires:["base","node","commonutils"],skinnable:true},conversationpicker:{path:D?"p/conversationpicker.js":null,requires:G,skinnable:true,lang:A},groupaddrequest:{path:D?"p/groupaddrequest.js":null,requires:["yim-intl","commonutils"],skinnable:true,lang:A},tabbedconversations:{path:D?"p/tabbedconversations.js":null,requires:["conversation","tabview","plugin","substitute","commonutils","yim-intl","conversationapi","globalconstants"],skinnable:true},addcontact:{path:D?"p/addcontact.js":null,requires:["widget","substitute","commonutils","yim-intl","globalconfig","globalconstants","contactsmanager"],skinnable:true,lang:A},"popupmenu-plugin":{path:D?"p/popupmenu-plugin.js":null,requires:["node-focusmanager","plugin"]},contactmenu:{path:D?"p/contactmenu.js":null,requires:["common-ui-intl-bidi","widget","substitute","popupmenu-plugin","commonutils","yim-intl","globalconfig","conversationmanager"],skinnable:true},"yim-intl":{path:D?"p/yim-intl.js":null,lang:I,requires:["intl","yim-lang"]},"yim-lang":{path:D?"p/yim-lang.js":null,lang:A,requires:["intl"]},smsinput:{path:D?"p/smsinput.js":null,requires:["widget","commonutils","yim-intl","commonutils-sms"],lang:A,skinnable:true},keyhandler:{path:D?"p/keyhandler.js":null,requires:["event","omapi"]}}}}};
if(B.isSecure&&!B.rtl){C.skin={overrides:{}};J=C.skin.overrides;var L=C.groups.yim.modules,H;for(H in L){if(L[H].skinnable){J[H]=["sam/ssl"];}}}else{if(B.rtl){var E=B.isSecure?"sam/rtl-ssl":"sam/rtl";C.skin={overrides:{}};J=C.skin.overrides;var L=C.groups.yim.modules,H;for(H in L){if(L[H].skinnable){J[H]=[E];}}}}window.YUI_config=YUI().mix(window.YUI_config||{},C,true,null,0,true);})();YUI.add("mim-api",function(A){},"@VERSION@");(function(){var C,G=window.launchData,E=["ar-JO","bg-BG","bn-BD","bn-IN","cs-CZ","da-DK","de-AT","de-DE","el-GR","en-GB","en-US","es-AR","es-ES","es-MX","es-US","et-EE","fi-FI","fil-PH","fr-BE","fr-CA","fr-FR","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","id-ID","it-IT","kn-IN","ko-KR","lt-LT","lv-LV","ml-IN","mr-IN","ms-MY","nb-NO","nl-BE","nl-NL","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","sr-Cyrl-RS","sv-SE","ta-IN","te-IN","th-TH","ti-PH","tl-PH","tr-TR","uk-UA","ur-PK","vi-VN","zh-Hans-CN","zh-Hant-HK","zh-Hant-TW"],H=G.filter=="min"?true:false,A=["widget","basewindow","globalconfig","events","tabview"];if(G.smsSupported){A.push("commonutils-sms");}C={filter:G.filter,lang:G.lang,filters:{},groups:{yimapp:{base:G.phonehomeData.base_url+"yimapp/build/",root:G.phonehomeData.root+"yimapp/build/",comboBase:G.phonehomeData.comboBase,combine:G.combine,filter:G.filter,lang:G.lang,timeout:5000,modules:{"basewindow":{path:H?"p/basewindow.js":null,requires:["base-base","node","event","widget","windowmanager","commonutils","globalconfig","sessionmanager","keyhandler"],skinnable:true},"optionswindow":{path:H?"p/optionswindow.js":null,requires:A,skinnable:true,lang:E},"addcontactwindow":{path:H?"p/addcontactwindow.js":null,requires:["basewindow","addcontact","keyhandler"],skinnable:true,lang:E},"smsinputwindow":{path:H?"p/smsinputwindow.js":null,requires:["basewindow","iowa-loader-api","smsinput"],lang:E},"signoutwindow":{path:H?"p/signoutwindow.js":null,requires:["basewindow","globalconfig","keyhandler"],skinnable:true,lang:E},"contactmenuwindow":{path:H?"p/contactmenuwindow.js":null,requires:["basewindow","contactmenu","yim-intl"],skinnable:true,lang:E},"mintymainwindow":{path:H?"p/mintymainwindow.js":null,requires:["basewindow","contactlist","yim-intl"],skinnable:true,lang:E},"tabbedmessagewindow":{path:H?"p/tabbedmessagewindow.js":null,requires:["basewindow","tabbedconversations","yim-intl","globalconfig"],skinnable:true,lang:E},"conversationwindow":{path:H?"p/conversationwindow.js":null,requires:["basewindow","conversation","globalconstants"]},"dialogwindow":{path:H?"p/dialogwindow.js":null,requires:["basewindow"],skinnable:true,lang:E},"windowmanager":{path:H?"p/windowmanager.js":null,requires:["base","om-window-api","oui-basewindow","yim-intl","events","commonutils","globalconfig","omapi"]},"addignorewindow":{path:H?"p/addignorewindow.js":null,requires:["basewindow","contactsmanager"],skinnable:true,lang:E},"reportabusedialog":{path:H?"p/reportabusedialog.js":null,requires:["basewindow","contactsmanager","conversationmanager"],skinnable:true,lang:E},"mim-application":{path:H?"p/mim-application.js":null,requires:["base-base","windowmanager","omapi","sessionmanager","contactsmanager","delayloader"]}}}}};if(G.isSecure&&!G.rtl){C.skin={overrides:{}};overrides=C.skin.overrides;var F=C.groups.yimapp.modules,D;for(D in F){if(F[D].skinnable){overrides[D]=["sam/ssl"];}}}else{if(G.rtl){var B=G.isSecure?"sam/rtl-ssl":"sam/rtl";C.skin={overrides:{}};overrides=C.skin.overrides;var F=C.groups.yimapp.modules,D;for(D in F){if(F[D].skinnable){overrides[D]=[B];}}}}YUI_config=YUI().mix(window.YUI_config||{},C,true,null,0,true);})();(function(){var B,E=window.launchData,G=E.filter=="min"?true:false,F,D,C;B={filter:E.filter,lang:E.lang,filters:{},groups:{"ytogo-mim-api":{base:E.phonehomeData.base_url+"ytogo/build/",root:E.phonehomeData.root+"ytogo/build/",comboBase:E.phonehomeData.comboBase,combine:E.combine,filter:E.filter,lang:E.lang,modules:{"oui-window-modder":{path:G?"p/oui-window-modder.js":null,requires:["om-window-api"]},"oui-basewindow":{path:G?"p/oui-basewindow.js":null,requires:["node","om-window-api","oui-window-modder"]},"om-window-api":{path:G?"p/om-window-api.js":null,requires:[]}}}}};if(E.isSecure&&!E.rtl){B.skin={overrides:{}};F=B.skin.overrides;D=B.groups["ytogo-mim-api"].modules;for(C in D){if(D[C].skinnable){F[C]=["sam/ssl"];}}}else{if(E.rtl){var A=E.isSecure?"sam/rtl-ssl":"sam/rtl";B.skin={overrides:{}};F=B.skin.overrides;D=B.groups["ytogo-mim-api"].modules;for(C in D){if(D[C].skinnable){F[C]=[A];}}}}YUI_config=YUI().mix(window.YUI_config||{},B,true,null,0,true);})();YUI.add("rtc-api-xframe",function(B){var A=YUI.namespace("Messenger");if(!A.RtcApiXframe){A.RtcApiXframe=(function(){function M(U){var W=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,S=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],V=/(?:^|&)([^&=]*)=?([^&]*)/g,Q=W.exec(U),T={queryKey:{}},R=S.length;while(R--){T[S[R]]=Q[R]||"";}T.query.replace(V,function(Y,X,Z){if(X){T.queryKey[X]=Z;}});return T;}var H="xframe-proxy_20110929.html";if(launchData.isSecure){H="xframe-proxy_20120309.html";}var L={yim_core:{url:"",remote_relay_path:"/remoteRelay.html",proxy_path:"/"+H+"?bc",parsed_url:null,remote_relay:null,proxy_url:null,xframe:null},yim_notify:{url:"",remote_relay_path:"/v2/xframe/remoteRelay.html",proxy_path:"/v2/xframe/"+H+"?bc",parsed_url:null,remote_relay:null,proxy_url:null,xframe:null},ssp:{url:launchData.isSecure?"https://ycpi-mail-preferences.msg.yahoo.com":"http://preference.msg.yahoo.com",remote_relay_path:"",proxy_path:"/"+H+"?cb",parsed_url:null,remote_relay:null,proxy_url:null,xframe:null}};if(launchData.urlParams&&launchData.urlParams.ymsgrstage){L.yim_core.url=launchData.isSecure?"https://ycpi-mail-rest-core-stage.msg.yahoo.com":"http://stage.rest-core.msg.yahoo.com";L.yim_notify.url="";}else{if(launchData.urlParams&&launchData.urlParams.ymsgralpha){L.yim_core.url=launchData.isSecure?"https://ycpi-mail-rest-core-alpha.msg.yahoo.com":"http://alpha.rest-core.msg.yahoo.com";}else{if(launchData.urlParams&&launchData.urlParams.ymsgrenv){L.yim_core.url=launchData.urlParams.ymsgrenv;}}}if(launchData.urlParams&&launchData.urlParams.ymsgrpws){L.ssp.url=launchData.urlParams.ymsgrpws;}var N=M(location.href);var I=N.protocol+"://"+N.authority+N.directory+"localRelay.html";if(window.openmail){var G=window.location;I=G.protocol+"//"+G.hostname+G.pathname+G.search.replace("yimapp","localRelay").replace("-dev","");}function F(Q){L[Q].parsed_url=M(L[Q].url);L[Q].remote_relay=L[Q].parsed_url.protocol+"://"+L[Q].parsed_url.authority+L[Q].remote_relay_path;L[Q].proxy_url=L[Q].parsed_url.protocol+"://"+L[Q].parsed_url.authority+L[Q].proxy_path;if(L[Q].xframe!==null&&L[Q].xframe.destroy){L[Q].xframe.destroy();}if(L[Q].url&&L[Q].url!==""){if(!this.xframePath){this.xframePath=launchData.phonehomeData.base_url+"yim/build/p/xframe.js";if(launchData.urlParams.ymsgrraw){this.xframePath=launchData.phonehomeData.base_url+"yim/build/xframe/xframe.js";}else{if(launchData.urlParams.ymsgrdebug){this.xframePath=launchData.phonehomeData.base_url+"yim/build/xframe/xframe-debug.js";}}}L[Q].xframe=new B.Messenger.Xframe({yim_core:L[Q].url,proxy:L[Q].proxy_url,localRelay:I,remoteRelay:L[Q].remote_relay,xframePath:this.xframePath,yuiPath:window.YUI_SRC});}}function E(){F("yim_core");F("yim_notify");}function C(Q,R){if(B.Lang.isString(R)&&(!L[Q].xframe||R!==L[Q].url)){L[Q].url=R;F(Q);}else{if(!R){L[Q].url=null;L[Q].xframe&&L[Q].xframe.destroy();L[Q].xframe=null;}}}function P(Q){if(L[Q]){return L[Q].url;}return undefined;}function O(Q){L["yim_core"].xframe.sendLogoutURL(Q);}function D(c,b,R,a,T,d,e,f,Q,Z){var U,g=T.split(" "),S=g[0],j=g[1],V=g[2],h=R||[],Y=L[j].xframe,X=null,i;if(S=="DELETE"&&j!=="ssp"){h.push("_method=delete");S="POST";}try{X=a?B.JSON.parse(a):null;}catch(W){}i=X?X.convId:null;if(b&&b.length>0){b="/"+b.join("/");}else{b="";}if(c!="GET_CRUMB"){h.push("sid="+encodeURIComponent(e));h.push("c="+encodeURIComponent(d));}h.push("msgrAppId=mim");h.push("cache="+(new Date()).getTime());V+=b+"?"+h.join("&");if(!Y){F(j);Y=L[j].xframe;}Y.send(S,V,a,function(l){a=a||"";var n,k={};if(B.Lang.isString(l)&&B.Lang.trim(l)!==""){try{n=B.JSON.parse(l);}catch(m){}}else{if(B.Lang.isObject(l)){n=l;}}n=n||{};if(n.responseText&&!n.responseObj){try{n.responseObj=B.JSON.parse(n.responseText);}catch(m){}}if(n.responseObj&&n.responseObj.error){n.error=n.responseObj.error;}if(a!==""){try{k=B.JSON.parse(a);}catch(m){}}n.body=k;n.parameters=R;n.convId=i;Q(f,c,n);},Z);}function J(){B.each(L,function(Q){if(Q.xframe){try{Q.xframe.destroy();}catch(R){}}});}function K(Q){var R=L[Q].xframe;R.cancelRequests();}return{getTransport:function(){return D;},canFetchCrumb:function(){return true;},setServiceURL:C,getServiceURL:P,setLogoutURL:O,killConnections:J,initialize:E,cancelRequests:K,issueRequest:D};})();if(A.RtcApi){A.RtcApi.setup(A.RtcApiXframe);}}B.namespace("Messenger").RtcApiXframe=A.RtcApiXframe;},"@VERSION@");YUI.add("xframe",function(C){var B=1000;function A(D){A.superclass.constructor.apply(this,arguments);}A.NAME="yim-xframe";A.ATTRS={api:{value:""},proxy:{value:""},localRelay:{value:""},remoteRelay:{value:""},isProxy:{value:false},logoutURL:{value:"",setter:function(D){if(D&&D!=""&&!this._unloadHandler){if(window.addEventListener){window.addEventListener("unload",C.bind(this._logoutOnUnload,this),false);}else{window.attachEvent("onunload",C.bind(this._logoutOnUnload,this));}this._unloadHandler=true;}return D;}},xframePath:{value:""},yuiPath:{value:""}};C.extend(A,C.Base,{initializer:function(D){var I=this.get("isProxy"),G=this.genKey();var J=window.postMessage?"wpm":"ifh";this.set("transport",J);this._iframe_loaded=false;this.set("localKey",G);var F=I?"message":YUI.guid("msg_");this.localId=F;this._listeners=[];this._parseTimers=[];this._pendingRequests={};this.chunks=[];this.chunkCount=0;this._boundReceive=C.bind(this._receive,this);if(window.addEventListener){window.addEventListener("message",this._boundReceive,false);}else{window.attachEvent("onmessage",this._boundReceive);}YUI.Env.globalEvents.on(F,this._boundReceive);this._cbs={};this._cbid=0;this._sendQueue=[];this._iframePool=[];this._connectionEstablished=false;if(I){var E=location.href.split("#")[1].split("*");this.set("remoteKey",E[0]);this.set("api",E[1]);this.set("remoteRelay",E[2]);this.set("remoteId",E[3]);this.domainCheck();this.__send(C.JSON.stringify({token:G,key:this.get("remoteKey")}),parent,this.get("remoteId"),this.get("otherDomain"));}else{this.set("proxyName",YUI.guid());this._url=[this.get("proxy"),"#",G,"*",this.get("api"),"*",this.get("localRelay"),"*",this.localId,"*y=",this.get("yuiPath"),"*","xframePath=",this.get("xframePath")].join("");var H=this.emitInvisibleIframe(this._url,this.get("proxyName"));this.set("iframe",H);}},genKey:function(){return(this.get("isProxy")?"proxy":"main")+"_"+Math.floor(1000000000000000000*Math.random()).toString(36);},destructor:function(){var E=null,G,D,F;this._destroyed=true;if(this.iframe_load_timeout){this.iframe_load_timeout.cancel();this.iframe_load_timeout=null;}if(this.iframe_onloadfired_timeout){this.iframe_onloadfired_timeout.cancel();this.iframe_onloadfired_timeout=null;}while(this._parseTimers.length>0){this._parseTimers.pop().cancel();}while(this._iframePool.length>0){E=this._iframePool.pop();this._destroyIframe(E);}for(G in this._pendingRequests){if(this._pendingRequests.hasOwnProperty(G)){F=this._pendingRequests[G].request;D=this._pendingRequests[G].timer;if(D){clearTimeout(D);}if(F){F.onreadystatechange=null;}}}delete this._requestTimers;E=this.get("iframe");if(E){this._destroyIframe(E);}while(this._listeners.length){this._listeners.pop().detach();}},parseURI:function(H){var J=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,F=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],I=/(?:^|&)([^&=]*)=?([^&]*)/g,D=J.exec(H),G={queryKey:{}},E=F.length;while(E--){G[F[E]]=D[E]||"";}G.query.replace(I,function(L,K,M){if(K){G.queryKey[K]=M;}});return G;},domainCheck:function(){if(this.get("otherDomain")){return;}var H=this.get("remoteRelay"),F=this.parseURI(H),E=F.host,D=[".flickr.com",".yahoo.com"];while(D.length){var G=D.shift();if(E.substr(E.length-G.length)===G){this.set("otherDomain",F.protocol+"://"+F.host);return;}}throw new Error("Unknown origin domain: "+E);},send:function(I,E,D,H,F){if(this._fatalError){H({error:{code:701,detail:"Xframe initialization error"}});return;}var G=this.get("proxyWindow");if(!G){this._sendQueue.push({method:I,url:E,body:D,callback:H,timeout:F});}else{return this._send(I,E,D,H,F);}},_send:function(K,F,D,J,H){var E=++this._cbid,I=C.JSON.stringify({cbid:E,method:K,url:F,body:D,key:this.get("remoteKey"),timeout:H});this._cbs[E]=J;if(this.get("proxyWindow")){this.__send(I,this.get("proxyWindow"),null,this.get("proxy"));}else{var G=this;setTimeout(function(){G.__send(I,G.get("proxyWindow"),null,G.get("proxy"));},8000);}},_receive:function(H){if(H._event&&!H.data){H.data=H._event.data;H.source=H._event.source;}if(H.total>0){this.chunks[H.index]=H.data;this.chunkCount++;if(this.chunkCount==H.total){H.data=this.chunks.join("");this.chunks=[];this.chunkCount=0;}else{return;}}var F=this.get("isProxy"),G={},E=this,I=H.source;G=C.Lang.trimLeft(H.data);if(!G.length||(G.charAt(0)!=="{"&&G.charAt(0)!=="[")){return;}try{G=C.JSON.parse(H.data);}catch(D){G={};}this._parseTimers.push(C.later(0,this,function(){if(this._destroyed||!G||G.key!==this.get("localKey")){return;}if(F){if(!C.Lang.isUndefined(G.logoutURL)){this.set("logoutURL",G.logoutURL);}else{if(G.command&&G.command=="cancelRequests"){this._cancelRequests();}else{this.ajax(G.method,G.url,G.body,function(O){var N=C.JSON.stringify({cbid:G.cbid,text:O,key:E.get("remoteKey")});E._parseTimers.push(C.later(0,E,function(){if(!this._destroyed){this.__send(N,I,I,this.get("otherDomain"));}}));},G.timeout);}}}else{if(G.token){this._connectionEstablished=true;if(this.iframe_load_timeout){this.iframe_load_timeout.cancel();this.iframe_load_timeout=null;}this.set("remoteKey",G.token);this.domainCheck();this.set("proxyWindow",this.get("iframe").contentWindow);while(this._sendQueue.length){var J=this._sendQueue.shift();this._send(J.method,J.url,J.body,J.callback,J.timeout);}}else{var M=this._cbs[G.cbid],L=G.text;delete this._cbs[G.cbid];try{M(L);}catch(K){}}}},this));},__send:function(F,H,G,E){switch(this.get("transport")){case"wpm":try{H.postMessage(F,E);}catch(D){if(!this._pmRetry){this._pmRetry=true;C.later(100,this,function(){this.__send(F,H,G,E);});}else{this._initializationFailure();}return;}this._pmRetry=false;break;case"ifh":this.callIfpc(F,G);break;}},ajax:function(K,F,D,J,H){if(C.Lang.isUndefined(K)||C.Lang.isUndefined(F)){return;}var G,I=C.guid("xframereq_"),E=false;if(window.XMLHttpRequest){G=new XMLHttpRequest();}else{G=new ActiveXObject("Microsoft.XMLHTTP");
}G.open(K,this.get("api")+F,true);G.setRequestHeader("Content-Type","application/json;charset=utf-8");G.setRequestHeader("X-Yahoo-Msgr-User-Agent","YahooMessenger/1.0 (Mail Messenger;1.0.0.0)");this._pendingRequests[I]={};this._pendingRequests[I].request=G;G.onreadystatechange=C.bind(function(){try{var L=4;if(G.readyState==L&&!E){E=true;var P="{}",O="status unavailable";try{O=G.statusText;}catch(N){}if(G.status>=200&&G.status<210){P=G.responseText;}else{if((G.status==0)||(G.status>1000)){P=C.JSON.stringify({error:{code:800,detail:"Network error"},httpStatus:G.status,responseText:G.responseText||""});}else{P=C.JSON.stringify({error:{},httpStatus:G.status,detail:O,responseText:G.responseText||""});}}J(P);}}catch(M){try{J(C.JSON.stringify({error:{code:600,detail:"internal Xframe error"}}));}catch(N){}}if(E){clearTimeout(this._pendingRequests[I].timer);delete this._pendingRequests[I];G.onreadystatechange=null;G.abort=null;G=null;}},this);this._pendingRequests[I].timer=setTimeout(C.bind(function(){if(G){G.onreadystatechange=null;try{G.abort();}catch(L){}G.abort=null;G=null;}if(this._pendingRequests[I]){delete this._pendingRequests[I];}J({error:{code:700,detail:"Client Side Timeout"}});},this),(H||1800)*1000);G.send(D||"");},cancelRequests:function(){if(!this._destroyed&&this.get("transport")==="wpm"){var E=this.get("proxyWindow");if(!E){return;}var D=C.JSON.stringify({command:"cancelRequests",key:this.get("remoteKey")});this.__send(D,E,null,this.get("proxy"));}},_cancelRequests:function(){var F,D;for(F in this._pendingRequests){if(this._pendingRequests.hasOwnProperty(F)){D=this._pendingRequests[F];try{D.request.abort();}catch(E){}D.timer&&clearTimeout(D.timer);}}this._pendingRequests={};},_initializationFailure:function(){while(this._sendQueue.length){var D=this._sendQueue.shift();D.callback({error:{code:701,detail:"Xframe initialization error"}});}this._fatalError=true;},_retryIframeLoad:function(){if(this.get("transport")=="wpm"&&!this._destroyed&&!this._connectionEstablished){var D=this.get("iframe");if(D){this._destroyIframe(D);}this._iframeRetryCounter++;var E=this.emitInvisibleIframe(this._url,this.get("proxyName"));this.set("iframe",E);}},emitInvisibleIframe:function(D,E){var I,N=D,O;this._iframeRetryCounter=this._iframeRetryCounter||0;if(this._iframeRetryCounter===1){var F=N.indexOf("?"),L=N.indexOf("#");if(F>-1&&F<L){N=N.split(N.substring(F,L)).join("");this._src=N;}}else{if(this._iframeRetryCounter>4){this._initializationFailure();return;}}if(!E){for(var J=this._iframePool.length-1;J>=0;--J){var H=this._iframePool[J];try{if(H&&(H.recyclable||H.readyState==="complete")){H.parentNode.removeChild(H);if(window.ActiveXObject){this._destroyIframe(H);this._iframePool[J]=H=null;this._iframePool.splice(J,1);}else{H.recyclable=false;I=H;break;}}}catch(K){}}}if(!I){var G=document.createElement("div"),M='<iframe id="'+(E||"")+'" style="visibility:hidden;position:absolute;border:none;height:0px;width:0px;left:-9999px;"></iframe>';G.innerHTML=M;I=G.firstChild;if(!E){this._ieCraziness=true;this._iframePool.push(I);}}this._listeners.push(C.on("load",function(){if(!this._destroyed){if(this.iframe_onloadfired_timeout){this.iframe_onloadfired_timeout.cancel();this.iframe_onloadfired_timeout=null;this._iframe_loaded=true;}if(this._ieCraziness){this.recyclable=true;}if(!this._connectionEstablished&&!this._destroyed){this.iframe_load_timeout=C.later(5000,this,function(){this._retryIframeLoad();});}}},I,this));this._listeners.push(C.on("error",function(){if(!this._connectionEstablished&&!this._destroyed&&!this._iframe_loaded){this._retryIframeLoad();}},I,this));C.later(0,this,function(){if(!this._destroyed){I.src=N;document.body.appendChild(I);if(!this.iframe_onloadfired_timeout){O=3000+this._iframeRetryCounter*1000;this.iframe_onloadfired_timeout=C.later(O,this,function(){if(!this._destroyed&&!this._iframe_loaded){this._retryIframeLoad();}});}}});return I;},callIfpc:function(H,E,L,M,N){if(!L){if(H.length>B){var J=[],I,G;while(H.length>B){J.push(H.substr(0,B));H=H.substr(B);}J.push(H);G=J.length;for(I=0;I<G;I++){this.callIfpc(J[I],E,true,I,G);}return;}}var F=this.get("remoteRelay"),K=this.get("isProxy"),O=K?"..":this.get("proxyName"),P=this.get("remoteId");if(!F){}M=M||0;N=N||0;var D=[F,"#",O,"&",P,"&",M,"&",N,"&",encodeURIComponent(H)].join("");this.emitInvisibleIframe(D);},_destroyIframe:function(E){var F=this.get("transport");try{if(E.destroy){E.remove();if(F=="wpm"){E.set("src","");}E.destroy();}else{if(E.parentNode){E.parentNode.removeChild(E);}if(F=="wpm"){E.src="";}}}catch(D){}},sendLogoutURL:function(D){if(!this._destroyed&&this.get("transport")=="wpm"){var F=this.get("proxyWindow");if(!F){C.later(5000,this,function(){this.sendLogoutURL(D);});return;}var E=C.JSON.stringify({logoutURL:D,key:this.get("remoteKey")});this.__send(E,F,null,this.get("proxy"));}},_logoutOnUnload:function(D){var F=this.get("logoutURL"),H;if(F){if(typeof XMLHttpRequest!="undefined"){H=new XMLHttpRequest();}else{if(window.ActiveXObject){try{H=new ActiveXObject("MSXML2.XMLHttp.6.0");}catch(E){}}}if(!H){return;}H.open("get",F,false);H.setRequestHeader("X-Yahoo-Msgr-User-Agent","YahooMessenger/1.0 (Mail Messenger;1.0.0.0)");H.timeout=3000;try{H.send(null);}catch(G){}C.later(3000,this,function(){H.abort();});}}});C.namespace("Messenger").Xframe=A;},"@VERSION@",{requires:["json","base-base"]});YUI.add("events",function(E){var A=YUI.namespace("Messenger");if(!A.Events){var C=function(){};C.APP_INIT_COMPLETE="yim:initdone";C.DELAY_LOAD_EVENT="yim:delayload";C.SHOW_WINDOW="yim:showWindow";C.HIDE_WINDOW="yim:hideWindow";C.WAIT_WINDOW="yim:waitWindow";C.FATAL_IO_ERROR="RequestManager:FATAL_ERROR";C.LOGGED_OUT="RequestManager.LOGGED_OUT";C.SELF_PRESENCE_CHANGED="yim:ownPresenceChanged";C.CONNECTION_UPDATE="yim:connupdate";C.MPOP_STATE_CHANGE="yim:mpopstatechange";C.SELF_IMAGE_UPDATED="yim:ownImageUpdated";C.SESSION_EXPIRED="yim:sessionExpired";C.LOGGED_IN="yim:loggedin";C.EXPLICIT_LOGIN="yim:loginexplicit";C.USER_BLOCKED="yim:userblocked";C.USER_UNBLOCKED="yim:userunblocked";C.CONTACT_IMAGE_UPDATED="yim:displayimage";C.CONTACTS_UPDATED="yim:contactsupdated";C.CONTACTS_ADDED="yim:contactsadded";C.CONTACT_DELETED="yim:contactsdeleted";C.CONTACT_REMOVED_FROM_GROUP="yim:contactremovedfromgroup";C.CONTACT_MOVED="yim:contactmoved";C.SHOW_CONVERSATION="yim:showconv";C.CONVERSATION_INITIATED="yim:convinitiated";C.MESSAGE_SEND_ERROR="yim:msgerror";C.MESSAGE_RECEIVED="yim:messagereceived";C.MESSAGE_SENT="yim:messagesent";C.FLASH_TAB="yim:flashtab";C.AUDIO_ALERT_NEWMESSAGE="yim:audionewmessage";C.GROUP_COLLAPSE_CHANGE="yim:groupCollapseChange";C.CONTACT_MENU_CLOSED="yim:contactmenuclosed";C.IM_TAB_SWITCHED="yim:tabswitched";C.AB_DATA_RECEIVED="abdatareceived";C.DELETE_FROM_AB="deletefromab";C.PRESENCE_PREF_UPDATED="yim:selfpresenceset";C.CLOSE_CONVERSATION="yim:closeconv";C.CONV_MODE_CHANGE="yim:convmodechange.";C.CLOSE_ALL_CONVERSATIONS="yim:closeallconv";C.START_CONVERSATION_DRAGDROP="yim:showconvdragdrop";C.SELECT_CONTACT="yim:selectcontact";C.CONTACT_DESTROYED="yim:contactnodedestroyed";C.CONTACT_AUTHORIZE_RESPONSE="yim:contactauthorizeresponse";C.CONTACT_ADD_RESPONSE="yim:contactaddresponse";C.BLOCK_NONBUDDIES_SETTING_CHANGED="yim:blocknonbuddieschange";C.OPEN_ADD_CONTACT="yim:openaddcontact";C.ADD_CONTACT_SENT="yim:addcontactreqsent";C.CONTACTLIST_RESIZED="yim:contactlistresized";C.SYNC_WINDOW_SIZE="yim:syncwindowsize";C.SIGNOUT_CANCELLED="yim:signoutwindowcancelled";C.WINDOW_FOCUSED="yim:windowfocused";C.WINDOW_BLURRED="yim:windowblurred";C.WINDOW_FOCUS_CHANGE="yim:focusedValueChanged";C.CLOSE_ADD_CONTACT="yim:closeaddcontact";C.CLOSE_CONV_PICKER="yim:closeconvpicker";C.CONVERSATION_ACK_RECEIVED="yim:conversationAcked";C.ACK_CONVERSATION="yim:ackconv";C.CLOSE_GROUP_REQUEST_TAB="yim:closeGroupRequestTab";C.CLOSE_SELECTED_CONVERSATION_TAB="yim:closeselectedconvtab";C.SELECT_NEXT_CONV_TAB="yim:selectnextconvtab";C.SELECT_PREV_CONV_TAB="yim:selectprevconvtab";C.CLOSE_ADD_CONTACT_AUTH="yim:closeaddcontactauthorize";C.OPEN_CONTACT_MENU="yim:opencontactmenu";C.CLOSE_CONTACT_MENU="yim:closecontactmenu";C.UPDATE_CONTACTMENU_WINDOW="yim:updatecontactmenu";C.OPEN_SMS_INPUT="yim:opensmsinput";C.CLOSE_SMS_INPUT="yim:closesmsinput";C.OPEN_SIGN_OUT_DIALOG="yim:opensignoutdialog";C.CLOSE_SIGN_OUT_DIALOG="yim:closesignoutdialog";C.USER_ACTION_SIGN_OUT="yim:usersignout";C.IGNORE_LIST_RECEIVED="yim:ignorelistreceived";C.OPEN_SSA_VIEWER="yim:openssaviewer";C.FILE_TRANSFER_INVITE="yim:filetransferinvite";C.FILE_TRANSFER_RECEIVE="yim:filetransferreceive";C.FILE_TRANSFER_SEND="yim:filetransfersend";C.OPEN_ADD_CONTACT_AUTHORIZE="yim:openaddcontactauthorize";C.PRESENCE="yim:presence";C.VISIBILITY_CHANGED="yim:visibilitychanged";C.NEW_CONTACT="yim:newcontact";C.TYPING_NOTIFICATION="yim:typingnotification";C.CONTACT_AUTHORIZE_REQUEST="yim:contactauthorizerequest";C.MULTIPLE_CONTACT_AUTHORIZE_REQUEST="yim:multiplecontactauthorizerequest";C.CONTACT_AUTH_REQ_SENT="yim:contactauthorizerequestsent";C.CREDITS_UPDATE="yim:credsupdate";C.LOGGEDIN_ID="yim:loggedinid";C.OPEN_MAIN_MENU="yim:openmainmenu";C.OPEN_SMS_CONV_PICKER="yim:opensmsconvpicker";C.OPEN_REPORT_ABUSE_DIALOG="yim:openreportabuse";C.OPEN_CONV_PICKER="yim:openconvpicker";C.RECENT_MESSAGES_RECEIVED="yim:recentmessagesreceived";C.TOGGLE_TOP_BAR="yim:toggletopbar";C.IGNORE_SUCCESSFUL="yim:ignoresuccess";C.IGNORE_FAILED="yim:ignorefailed";C.USER_UNBLOCKED="yim:userunblocked";C.UNBLOCK_SUCCESSFUL="yim:unblocksuccess";C.SHOW_OPTIONS_DIALOG="yim:showoptionsdialog";C.OPTIONS_DIALOG_START_TAB="yim:selectoptionsdialogtab";C.SOCIALCONNECTION_UPDATED="socialConnectionUpdated";C.LOGOUT_FACEBOOK="logoutFacebook";C.LOGIN_FACEBOOK="loginFacebook";C.LOGIN_FACEBOOK_FAIL="loginFacebook_fail";C.MODAL_WINDOW_OPENED="oui-modalwindow-event";C.MODAL_WINDOW_CLOSED="oui-modalwindow-closed";C.SET_WINDOW_FOCUS="oui-set-window-focus";C.FB_PREFERENCE_RECEIVED="ssp:received";C.SSP_PREFERENCE_RECEIVED="yim:sspprefreceived";C.NETWORK_ERROR="yim:network.error";C.NETWORK_ERROR_RESOLVED="yim:network.fixed";C.YTOGO_WINDOW_RESTORED="ytogo.WindowRestored";C.YTOGO_WINDOW_MINIMIZED="ytogo.WindowMinimized";C.YTOGO_WINDOW_HIDDEN="ytogo.WindowHidden";C.YTOGO_WINDOW_SHOWN="ytogo.WindowShown";C.YTOGO_WINDOW_TOFRONT="ytogo.WindowBroughtToFront";C.YTOGO_WINDOW_RESIZED="ytogo.WindowResized";C.YTOGO_WINDOW_POPOUT="ytogo:popoutWindow";C.YTOGO_WINDOW_POPIN="ytogo:popinWindow";C.YTOGO_WINDOW_TI_FOCUSED="ytogo.TIWindowFocused";C.NOTIFICATION="yim:notificationcreated";var B="all",D="id";C.CONVERSATION_EVENTS={LOGGEDIN_ID:{scope:B},CONVERSATION_ACK_RECEIVED:{scope:D},CONV_MODE_CHANGE:{scope:D},CLOSE_SMS_INPUT:{scope:D},CLOSE_ADD_CONTACT:{scope:D},PRESENCE:{scope:B},VISIBILITY_CHANGED:{scope:D},NETWORK_ERROR:{scope:B},NETWORK_ERROR_RESOLVED:{scope:B},SHOW_CONVERSATION:{scope:D},USER_BLOCKED:{scope:D},USER_UNBLOCKED:{scope:D},CONNECTION_UPDATE:{scope:B},LOGOUT_FACEBOOK:{scope:B},LOGIN_FACEBOOK:{scope:B},CONTACT_AUTH_REQ_SENT:{scope:D},NOTIFICATION:{scope:D},TYPING_NOTIFICATION:{scope:D},BLOCK_NONBUDDIES_SETTING_CHANGED:{scope:B},TOGGLE_TOP_BAR:{scope:B},IGNORE_FAILED:{scope:D},CONTACT_AUTHORIZE_REQUEST:{scope:D,openConv:true},CONTACT_AUTHORIZE_RESPONSE:{scope:D},CONTACT_IMAGE_UPDATED:{scope:D},CONTACTS_UPDATED:{scope:D},CONTACTS_ADDED:{scope:D},CONTACT_DELETED:{scope:D},SELF_IMAGE_UPDATED:{scope:B}};A.Events=C;}E.namespace("Messenger").Events=A.Events;
},"@VERSION@",{requires:["event"]});YUI.add("requestmanager",function(A){if(!YUI.namespace("Messenger").RequestManager){function G(J){G.superclass.constructor.apply(this,arguments);}G.NAME="yim-RequestManager";G.ATTRS={"crumb":{value:launchData.crumb},"sessionId":{value:null},"imToken":{value:null},"primaryLoginId":{value:null}};var E=window.location,D=110,I=120,B=20*60*1000,H=A.Messenger.Events,F=typeof(navigator.onLine)!="undefined",C=0;G.REQUESTS={"KEEPALIVE":{method:"PUT",path:"/v1/session/keepalive",args:["notifyServerToken=2"]},"GET_CRUMB":{method:"GET",path:"/v1/session",args:["amIOnline=0"]}};A.extend(G,A.Base,{initializer:function(K){this._notifyLog={};this._listeners={};this._watchers={};this._pendingRequests=[];var J=YUI.namespace("Messenger");this.transport=J.RtcApiRest||J.RtcApiXframe||J.RtcApiMock;if(!this.transport){}},destructor:function(){},setServerUrl:function(K,J){log("Connecting to server "+K);this.transport.setServiceURL(K,J);},issueRequest:function(P){if(!this.transport){throw new Error("Attempt made to issue a request using RequestManager before calling start");}var K=P.args?P.args.slice(0):[],O=P.server||"yim_core",Q=P.method,N=P.path,M=P.type,L=P.postBody;if(!this.get("crumb")){if(M!="GET_CRUMB"){if(this.get("sessionId")||M=="LOGIN"||(O!="yim_core"&&O!="yim_notify")){this.getCrumb();this._pendingRequests.push(P);return;}else{return;}}}else{if(!this.get("sessionId")&&(O=="yim_notify"||(O=="yim_core"&&M!="LOGIN"))){return;}}if(O=="yim_notify"){K.push("imtoken="+encodeURIComponent(this.get("imToken")));}var J=typeof(L)=="object"?JSON.stringify(L):L;if(O=="yim_core"&&!this.transport.getServiceURL(O)){if(launchData.isSecure){this.setServerUrl("yim_core","https://ycpi-mail-rest-core.msg.yahoo.com");}else{this.setServerUrl("yim_core","http://prod.rest-core.msg.yahoo.com");}}this.transport.issueRequest(M,"",K,J,[Q,O,N].join(" "),this.get("crumb"),this.get("sessionId"),++C,A.bind(function(T,R,S){if(S.error){log("Request error: type = "+M+", args = ["+K.join(",")+"], body = "+J+", response = "+JSON.stringify(S));if(S.error.code==-1002||R=="HANGING_GET"&&S.httpStatus=="403"){if(M!="GET_CRUMB"){if(!this._refreshingCrumb){this._refreshingCrumb=true;this.set("crumb",null);this.getCrumb();this._pendingRequests.push(P);return;}else{this._refreshingCrumb=false;this._handleSessionExpired();return;}}}else{switch(S.error.code){case 28:this._handleSessionExpired();break;case 4:case 30:this.handleLogout(true);return;break;case 700:this.issueRequest(P);return;break;case 701:this._pendingRequests.push(P);this._restartXframe(O);return;break;default:break;}}}else{if(M!="GET_CRUMB"&&this._refreshingCrumb){log("Crumb refresh successful");this._refreshingCrumb=false;}}if(S.error){P.errorCallback&&P.errorCallback(S);}else{P.successCallback&&P.successCallback(S);}},this),P.timeout);},_getNotifications:function(){this._notifySequence=this._notifySequence||0;if(this._notifyPending){return;}this._notifyPending=true;if(this._notifySequence===0){this._notifyTimer=A.later(15000,this,function(){log("Didn't receive a hanging get response in a reasonable amount of time - retrying the xframe load.");this._restartXframe("yim_notify");this._notifyPending=false;A.later(0,this,this._getNotifications);});}this.issueRequest({type:"HANGING_GET",timeout:I,server:"yim_notify",method:"GET",path:"/v1/pushchannel/"+this.get("primaryLoginId"),args:["seq="+this._notifySequence,"format=json","idle="+D],successCallback:A.bind(function(P){if(this._notifyTimer){this._notifyTimer.cancel();delete this._notifyTimer;}this._notifyPending=false;var L=P.responses||[],N,Q,M,K,J;if(!launchData.timers.presenceReceived){launchData.timers.presenceReceived=(new Date()).getTime();log("First hanging get response received");}if(this._hgRetryCount){this._hgRetryCount=0;A.Global.fire(H.NETWORK_ERROR_RESOLVED);}if(!this._heartbeat&&F){this._heartbeat=A.later(10000,this,this._checkNetwork,null,true);}for(N=0;N<L.length;N++){Q=L[N];for(M in Q){this._notifySequence++;if(M=="disconnect"){this._listening=false;}if(this._listeners[M]){for(K=0,J=this._listeners[M].length;K<J;K++){try{this._listeners[M][K](Q[M]);}catch(O){}}}else{this._notifyLog[M]=this._notifyLog[M]||[];this._notifyLog[M].push(Q[M]);}if(this._watchers[M]){for(K=0,J=this._watchers[M].length;K<J;K++){this._watchers[M][K](Q[M]);}}}}if(this._listening){this._getNotifications();}},this),errorCallback:A.bind(function(J){this._notifyPending=false;if(this._notifyTimer){this._notifyTimer.cancel();delete this._notifyTimer;}var K=this._hgRetryCount<10?500:5000;if(this._listening){if(!this._hgRetryCount){this._hgRetryCount=0;A.Global.fire(H.NETWORK_ERROR);}this._hgRetryCount++;A.later(K,this,this._getNotifications);}},this)});},_checkNetwork:function(){if(!navigator.onLine){this._heartbeat.cancel();delete this._heartbeat;this.transport.cancelRequests("yim_notify");}},_keepAlive:function(){var J=G.REQUESTS.KEEPALIVE;this.issueRequest({type:"KEEPALIVE",method:J.method,path:J.path,args:J.args,successCallback:A.bind(function(K){if(K.notifyServerToken&&K.notifyServerToken.token){this.set("imToken",K.notifyServerToken.token);}},this)});},startListening:function(){if(!this._listening){this._listening=true;this._notifySequence=0;this._getNotifications();this._keepaliveTimer=A.later(B,this,this._keepAlive,null,true);}},addListener:function(J,K){this._listeners[J]=this._listeners[J]||[];this._listeners[J].push(K);if(this._notifyLog[J]){while(this._notifyLog[J].length){K(this._notifyLog[J].pop());}}return(function(M,N,L){return{detach:function(){M._listeners[N].splice(L,1);}};})(this,J,this._listeners[J].length-1);},addListeners:function(L){var K,J;for(K=0,J=L.length;K<J;K++){this.addListener(L[K].id,L[K].callback);}},watchNotifications:function(L,M){var K,J;this._watchers[L]=this._watchers[L]||[];this._watchers[L].push(M);if(this._notifyLog[L]){for(K=0,J=this._notifyLog[L].length;K<J;K++){M(this._notifyLog[L][K]);}}return(function(O,P,N){return{detach:function(){O._watchers[P].splice(N,1);}};})(this,L,this._watchers[L].length-1);},handleLogout:function(J){this._clearState();
if(J){A.Global.fire(H.LOGGED_OUT);}},_handleSessionExpired:function(){this._clearState();A.Global.fire(H.SESSION_EXPIRED);},getCrumb:function(){var J=G.REQUESTS.GET_CRUMB;if(!this._crumbPending){this._crumbPending=true;this.issueRequest({type:"GET_CRUMB",method:J.method,path:J.path,args:J.args,successCallback:A.bind(function(K){this.set("crumb",K.crumb);while(this._pendingRequests.length){this.issueRequest(this._pendingRequests.pop());}this._crumbPending=false;},this),errorCallback:A.bind(function(K){this._crumbPending=false;A.Global.fire(H.FATAL_IO_ERROR);this._clearState();},this)});}},_clearState:function(){this.set("crumb",null);this.set("sessionId",null);this.set("imToken",null);this._pendingRequests=[];this._listening=false;this._notifySequence=0;this._crumbPending=false;this._notifyPending=false;if(this._heartbeat){this._heartbeat.cancel();delete this._heartbeat;}if(this._keepaliveTimer){this._keepaliveTimer.cancel();delete this._keepaliveTimer;}if(this._notifyTimer){this._notifyTimer.cancel();delete this._notifyTimer;}this._xframeRetryDone=false;this.transport.cancelRequests("yim_notify");},killConnections:function(){if(A.UA.ie&&this._logoutUrl){var J=new Image();J.src=this._logoutUrl;this._logoutUrl=null;}this.transport.killConnections();},setLogoutURL:function(J){this._logoutUrl=J;this.transport.setLogoutURL(J);},_restartXframe:function(K){if(this._xframeRetryDone){log("XFrame initialization error - retry already attempted, so logging the user out.");this.handleLogout(true);return;}log("XFrame initialization for server "+K+" failed.  Retrying the xframe init.");this._xframeRetryDone=true;var J=this.transport.getServiceURL(K);if(!J){throw new Error("Attempted to issue requests to a server that did not have a server URL set - "+K);}this.transport.setServiceURL(K,null);this.transport.setServiceURL(K,J);while(this._pendingRequests.length){this.issueRequest(this._pendingRequests.pop());}}});YUI.Messenger.RequestManager=new G();}A.namespace("Messenger").RequestManager=YUI.Messenger.RequestManager;},"@VERSION@",{requires:["base-base","xframe","events"]});