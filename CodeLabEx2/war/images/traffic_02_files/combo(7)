YUI.add("_shared_module_open_mail_webservice_container",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_open_mail_webservice_container={base:"<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' id='{{flash_id}}' width='1' height='1'> <param name='movie' value='{{flash_src}}'/> <param name='allowScriptAccess' value='always'/> <embed src='{{flash_src}}' width='1' height='1' name='{{flash_id}}' allowScriptAccess='always' type='application/x-shockwave-flash'> </embed></object>"};},"1.0.0");YUI.add("om-controller-webservice",function(B){var L=B.om,F=L.Controller,H=F.extend("Webservice"),E=L.common.Errors,I=L.common.Utils,G=L.model.DataStore,K=B.common.Utils,A=K.rocketstats;function D(N,M){var T="omapiwsobj",S="http://l.yimg.com/nq/ued/assets/flash/wsclient_4859.swf",R=null,Q=null,P,O;if(NeoConfig.isFullSSL&&S.match(/^http:\/\/l.yimg.com\/nq/)){S=S.replace(/^http:\/\/l/,"https://s");}P=K.substitute(B.ui.Templates._shared_module_open_mail_webservice_container.base,{flash_id:T,flash_src:S});window.wsclientFlashReady=function(){if(B.UA.ie===9){G.wsObject=document.getElementById(T);}else{G.wsObject=document[T]||window[T];}if(G.wsObject&&NeoConfig.om.wsdebug){G.wsObject.setDebug(true);}if(M){clearTimeout(R);clearTimeout(Q);M(true);}};window.wsclientReceive=function(Y,X,V,U){var W={data:(U==="text")?decodeURIComponent(X):X,httpStatus:V||null};N(G.wsCallMap[Y],W);delete G.wsCallMap[Y];};window.wsclientError=function(X,V,U){var W={error:E.ERR_FLASH_ERR,flashError:V.text,errorMsg:"Flash returned error "+V.text,httpStatus:U||null,errorDetail:{data:decodeURIComponent(V.data||""),errorID:V.errorID,type:V.type,text:V.text}};N(G.wsCallMap[X],W);delete G.wsCallMap[X];};window.wsclientLog=function(U){if(window.console){console.log("OM:WSClient",U);}};if(M){R=setTimeout(function(){M(false);},10000);}Q=setTimeout(function(){B.use("swfdetect",function(U){if(!U.UA.flashMajor){if(K.isBrowserCORSCapable()){U.use("io",function(V){V.io.header("X-Requested-With");G.wsObject={fetch:C};});clearTimeout(R);}}});},1500);O=document.createElement("DIV");O.style.position="absolute";O.style.top="-5000px";document.body.appendChild(O);O.innerHTML=P;}function C(O,N,M,R,Q,U){var V,S;function T(Y,W){var X="callWebService:"+(G.wsCallMap[O].appid)+":CORS:success:"+W.status;if(U==="binary"){receivedData=W.responseText;}else{receivedData=W.responseText;}window.wsclientReceive(O,receivedData,W.status,U);I.log(X);B.log(X);A.stat("OM","WS:CORS:success");}function P(Y,W){var X="callWebService:"+(G.wsCallMap[O].appid)+":CORS:failure:"+W.status;if(!W.status){V=G.wsCallMap[O],S=V.parameters.reason;F.Openapi.handleFlashRequired(V,S);}else{window.wsclientError(O,{data:W.responseText,type:"",text:W.statusText||"",errorID:""},W.status);}I.log(X);B.log(X);A.stat("OM","WS:CORS:failure");A.stat("OM","WS:CORS:failure:"+W.status);if(NeoConfig.log_error_yapache==1){B.use("common-utils-error",function(Z){Z.common.Utils.error.report("OM:"+X+":url:"+N);});}}B.io(N,{method:M||"GET",data:R||"",headers:J(Q),xdr:{use:"native"},on:{success:T,failure:P}});}function J(P){var Q={},O;if(!P){return Q;}for(var N=0,M=P.length;N<M;N++){O=(""+P[N]).match((/\s*([^:\s]*)\s*:\s*(.*)\s*/));if(O&&O[1]){Q[O[1]]=O[2];}}return Q;}B.mix(H,{createWebServiceObject:D},true);},"1.0.0",{requires:["om-controller-base","om-model-datastore","om-common-errors","om-common-utils","common-utils","_shared_module_open_mail_webservice_container"]});YUI.add("om-common-constants",function(A){A.mix(A.namespace("om.common.Constants"),{DIALOG_CANCEL:0,DIALOG_OK:1,OK:1,FAIL:0,UNDEFINED:2});},"1.0.0");YUI.add("om-controller-openapi",function(x){var AG=x.om,p=AG.Controller,u=p.extend("Openapi"),AV=AG.model.DataStore,AD=AV.Registry,m=AV.ViewRegistry,d=AV.EventRegistry,T=AV.OpenViewLog,AJ=AV.APP_FLAGS,V=AG.common.Utils,AN=AG.common.Errors,AH=AG.common.net.session,v={error:AN.ERR_NONE},AE=x.Lang,n=x.common.Utils,AU=x.common.net.SessionMgr,B=x.common.Utils.rocketstats,j="YahooMailNeoOM",Af=false,AB=[],E=100-Math.min(x.config.windowResizeDelay||40,100),r={getParameters:s,setListener:AC,callWebService:g,search:Ah,compose:z,draft:H,openView:i,closeView:AA,openMessage:X,setFolderConfig:AP,getAttachmentUrl:I,upgradeApplication:Ae,upgradeIfNecessary:Z,filterHTML:Q,setData:C,getData:M,removeData:P,getAuthStatus:W,getUserAuthorizationUrl:G,notifyAuthorizationComplete:R,removeAuthorization:F,callAuthWebService:b,getAuthParameters:Ac,reportJSError:AT,setTabCloseMessage:Aa},w={SCOPE_MISMATCH:1,SCOPE_NOT_EXIST:2},a={OMXDB_SUCCESS:0,OMXDB_FAILURE:-1,OMXDB_KEY_DOES_NOT_EXIST:-2,OMXDB_INSTANCE_DOES_NOT_EXIST:-3,OMXDB_EXPIRED:-4,OMXDB_LOWER_VERSION:-5,OMXDB_INVALID_KEY:-6,OMXDB_BUSY:-7};function s(Y,Aj,Al){var Ak=Y.parameters;if(Ak.reason==="data/message"&&Ak.data.from.name===undefined){if(V.compareVer(Y.apiVersion,"0.1.6")===-1){Ak.data.from=Ak.data.from[0];}}if(x.Lang.isObject(Ak.user)){Ak.user.themeinfo=NeoConfig.theme?{name:NeoConfig.theme.id,css:NeoConfig.theme.url}:{};}Al&&Al(Y,Ak);}function Ae(Y,Aj){x.use("om-controller-views",function(Am){var Ak=Y.id,Al=T.get(Ak);p.Views.closeView(Ak);AO(Y.appid,Y.instanceid,Al,false);});}function Z(Aj,Al){if(Al.error){Al.ctx=Aj;return;}var Y=Aj.id,Ak=T.get(Y);Ab(Aj,Ak,Al.suppressMessaging);}function I(Aq,Al){var Aj=Al.url,An,Ak,Ap,As,At={mimeurl:Aj},Y=0,Ao="&giveurl=1";if(Al.hasOwnProperty("longtimeout")){Y=Al.longtimeout;}function Ar(Av){try{return Av.match(/^http:\/\/.*\.yahoo\.com\/(proxy\/)?ya\/download\?.*/);}catch(Au){}return false;}try{if(!Ar(Aj)){At.error=AN.ERR_NOT_ATTACHMENT_URL;K(Aq,At,true);return;}An=function(Av,Au){At.url=Av.responseText;K(Aq,At);};Ak=function(Av,Au){var Aw=Av.body?Av.body.error:{code:-1};At.error=AN.ERR_UNDEFINED;At.errorMsg=Aw.code;K(Aq,At,true);};Ap={success:An,failure:Ak,responseType:"text",suppressWssid:true,suppressCodes:["*"],exceptCodes:[401,402,999],timeout:5000,args:{}};if(Y==1){Ao+="&longtimeout=1";}As=AU.request(Aj+Ao,null,Ap,"GET");As.send();}catch(Am){At.error=AN.ERR_UNDEFINED;K(Aq,At,true);}}function AK(Al,Ar,Y,As,Ao){var An,At,Am,Ak,Ap,Av,Aj,Au;try{if(!Al){if(Y){Y(null);}return;}Am="content="+encodeURIComponent(Al);if(Ao){Am+="&restrictOff=true";}Ak=function(Ay,Ax){var Aw;if(Ar){Aw=Ay.responseText;An=2;while(An--){At=Aw.lastIndexOf("-->");if(At===Aw.length-4){At=Aw.lastIndexOf("<!--");if(At!==-1){Aw=Aw.slice(0,At);}}}Ar(Aw);}};Ap=function(Ax,Aw){if(Ax.fault){B.stat("OM","ERR:yivValidate");B.stat("OM","ERR:yivValidate:"+Ax.fault.code);}if(Y){Y("YIV validation failed ."+(Ax&&Ax.responseText?Ax.responseText:""),Al);}};Au={success:Ak,failure:Ap,responseType:"x-www-form-urlencoded",suppressWssid:true,suppressCodes:["*"],exceptCodes:[401,402,999],timeout:5000,args:{}};Aj=Au.args;if(As){Aj.argument=As;}Av=AU.request("/om/yiv/om_yiv.php",Am,Au,"POST");Av.setHeader("Content-length",String(Am.length));Av.setHeader("Connection","close");Av.send();}catch(Aq){B.stat("OM","ERR:YIVValidation:"+x.JSON.stringify(Aq));Y("YIV Validation of message failed : "+Aq.description,Al);}}function Q(Y,Aj){function Al(Am){K(Y,{html:Am});}function Ak(Am,An){K(Y,{error:AN.ERR_UNDEFINED,errorMsg:Am});}AK(Aj.html,Al,Ak,null,true);}function Ab(Aj,Ak,Al){var Y=AD.get(Aj.appid).version;function Ap(Ar,Aq){K(Aj,{error:AN.ERR_UNDEFINED,errorMsg:"Couldn't fetch version"});}function An(Ar,Aq){var Au,As;try{Au=Ar.body;As=Au[0].version;if(As===undefined){K(Aj,{error:AN.ERR_UNDEFINED,errorMsg:"couldn't retrieve server version"});return;}if(Y>=As){K(Aj,{data:"app up to date (ver "+As+")"});return;}AO(Aj.appid,Aj.instanceid,Ak,Al);}catch(At){K(Aj,{error:AN.ERR_UNDEFINED,errorMsg:"exception during upgrade"});return;}}var Am={app:Aj.appid,ver:Y,lang:NeoConfig.lang,intl:NeoConfig.om.intl},Ao=AH.getBaseCallback("openmail.app.list",An,Ap);AU.request(AH.getUrlForModule(Ao.method),Am,Ao,"GET",null,true);}function AO(Al,Aj,Y,Ak){x.use("om-controller-views",function(An){var Ao=AV.ViewRegistry.getAll(),Ap=p.Views,Am=false,Aq=AD.isSandbox(Al)||AD.isMessenger(Al),As,Ar;function Au(){if(Y){Ap.openView.apply(this,Y);}}function At(){if(!Aq){Ap.closeApplication(Al,Aj);}AV.removeList=[];AV.updateList=[Al];var Av=Y?Au:null;An.use("om-controller-applicationlist",function(Aw){p.ApplicationList.getApplicationConfigs(Av);});}for(Ar in Ao){As=Ao[Ar];if(Ao.hasOwnProperty(Ar)&&Al===As.get("appId")){if(As.name&&As.name==="omHiddenView"||As.get("closing")){continue;}Am=true;break;}}if(Ak||!Am||Aq){At();return;}An.use("common-ui-dialog-helper",function(Ax){var Aw={hd:strings.str_om_tou_title,bd:strings.str_om_upgrade_choice};function Av(Ay){if(Ay.dataAction==="ok"){At();}}Ax.common.ui.DialogHelper.confirm(Aw,{ok:{handler:Av},cancel:{handler:Av}});});});}function g(Y,Aj){S(Y,Y.cbid,Aj.url,Aj.method,Aj.parameters,Aj.headers,Aj.dataformat);}function AW(Aj){for(var Y in Aj){if(Aj[Y].match(/^content-type:\s*application\/json/i)||Aj[Y].match(/^content-type:\s*multipart\/form-data/i)){return true;}}return false;}function Ai(Aj){for(var Y in Aj){if(Aj[Y].match(/^content-type:\s*application\/json/i)){return true;}}return false;}function f(Ak){var Aj={},Al,Am;for(var Y in Ak){Al=encodeURIComponent(Y);Am=encodeURIComponent(Ak[Y]);Aj[Al]=Am;}return Aj;}function AM(Ak,Al){var Y=Ak,Am=[];if(Al&&!n.isEmpty(Al)){if(Ak.search(/\?/)===-1){Y+="?";}if(Ak.search(/[\&=]/)!==-1){Y+="&";}for(var Aj in Al){Am.push(Aj+"="+Al[Aj]);}Y+=Am.join("&");}return Y;}function y(Y){if(Y!=="events/load"&&Y!=="events/message_read"&&Y!=="events/message_render"){x.use("common-ui-dialog-helper",function(Aj){Aj.common.ui.DialogHelper.alert({hd:strings.str_om_error_flash_unavailable_title,bd:strings.str_om_error_flash_unavailable_body});
});}B.stat("OM","Noflash_appinvoke");}function O(Y,Aj){var Ak;Ak={error:AN.ERR_FLASH_REQUIRED,errorMsg:"callWebService requires the client to have Flash installed."};y(Aj);K(Y,Ak,true);}function U(Y,Aj){var Ak;Ak={error:AN.ERR_FLASH_LAUNCH_ERR,errorMsg:"callWebService was unable to launch Flash.  Flash may be blocked or a Flash error may have occurred."};y(Aj);K(Y,Ak,true);}function AY(Y,Aj){return function(){S.apply(Y,Aj);};}function e(Au,Al,Aj,Y,Ao,An,Aq){var As=AV.wsObject,Ar=Aj,Am,At,Ak=(Y.search(/GET/i)!==-1)?true:false,Ap=Ai(An);Aq=Aq||"text";AV.wsCallMap[Al]=Au;V.log("callWebService",AD.getAppName(Au.appid)+".API");if(Ak){Ar=AM(Aj,f(Ao));}else{if(Ap){Am=Ao;}else{At=n.parseQueryString(Aj);if(At&&Ao){Am=n.merge(At,Ao);}else{if(Ao){Am=Ao;}else{Am=At;}}}}if(Ak){As.fetch(Al,Ar,Y,null,null,Aq);}else{As.fetch(Al,Ar,Y,Am,An,Aq);}}function S(Aq,Ak,Aj,Y,Am,Al,Ap){var An=Aj.substring(0,Aj.indexOf(":")),Ao;if(An==="apps"){if(!(p.Internalapi&&p.Internalapi.internalAPI)){x.use("om-controller-internalapi",function(Ar){p.Internalapi.internalAPI(Aq,Am);});}else{p.Internalapi.internalAPI(Aq,Am);}return;}if(AV.wsObject){e(Aq,Ak,Aj,Y,Am,Al,Ap);}else{x.use("swfdetect",function(Ar){if(!Ar.SWFDetect.isFlashVersionAtLeast(9,0,115)){Ao=Aq.parameters.reason;O(Aq,Ao);}else{if(Af){Ao=Aq.parameters.reason;U(Aq,Ao);}else{AB.push(AY(this,[Aq,Ak,Aj,Y,Am,Al,Ap]));}}});}}function Ah(Y,Aj){x.fire("search:input",{query:n.escapeHtml(Aj.query)});K(Y,v,true);}function C(Y,Aj){var Al,Ak;if(V.compareVer(Y.apiVersion,"0.1.7")===-1){Al=Aj.data;Aj.keys=[];Aj.ttl=[];for(Ak in Al){Aj.keys[Al[Ak][0]]=Al[Ak][1];if(Al[Ak][2]){Aj.ttl[Al[Ak][0]]=Al[Ak][2];}}delete Aj.data;}Ad(Y.instanceid,Y,Aj);}function Ad(Aw,Au,Az){function As(A1){K(Au,v,true);}function A0(A1){var A4=(A1.fault?A1.fault:A1.body.error)||{},A3=A4.code;A3=!A3||AH.isHttpError(A3)?A1.status:A3;B.stat("OM","ERR:setAppData:"+A3);var A2={error:AN.ERR_SET_DATA,errorMsg:A4.message||""};K(Au,A2,true);}var Aj=Aw.split("."),Y=AD.getProperty(Aj[0],"main_id"),At=A(Aj[0]),Ao="",Ap="",Am=0,Ay,An=[],Ar,Ax,Aq="/[?|*]/";Aq=new RegExp(Aq.substr(1,(Aq.length-2)),"g");for(Ax in Az.keys){Ao="_APP_"+Ax.replace(Aq,"");Ap=Az.keys[Ax];Ap=x.JSON.stringify(Ap);Am=Az.ttl?(Az.ttl[Ax]||0):0;if(Am!==0){Ay=new Date();Am+=Math.round(Ay.getTime()/1000);}An.push({key:Ao,value:Ap,extensionId:Y||Aj[0],instanceId:Aj[1],version:At,expiration:Am});}var Av={method:"SetExtensionData",params:[{setdata:An}],id:"123456789"},Ak="/ws/mailPreferences/v1/jsonrpc",Al={success:As,failure:A0,responseType:"json",suppressCodes:["*"],exceptCodes:[401,402,999]};Ar=AU.request(Ak,x.JSON.stringify(Av),Al,"POST");Ar.addUrlParam("appid",j);Ar.send();}function M(Y,Aj){AI(Y.instanceid,Y,Aj);}function AI(Ak,Av,Ar){var Aq=Ar.keys,Au=Ak.split("."),Aj=AD.getProperty(Au[0],"main_id"),Ao=0,Am=[],Aw,Al,An,Y,At;if(!AE.isUndefined(Ar.pageInfo)){Ao=Ar.pageInfo.iOffset;}function As(A3){var A5={},A6={},A1={},A8=[];if(!AE.isUndefined(Ar.pageInfo)){A5=Ar.pageInfo.oPagedData;A6=Ar.pageInfo.oPagedVer;A1=Ar.pageInfo.oPagedErr;A8=Ar.pageInfo.keyErrors;}var Ax=A3.body,Az=Ax.result.data,A9="",A2=null,A4;for(A4 in Az){A9=Az[A4].key.substr("_APP_".length);A2=Az[A4].value;try{A5[A9]=A2?x.JSON.parse(A2):A2;}catch(A7){A5[A9]=A2;}A6[A9]=Az[A4].version;switch(Az[A4].errorCode){case a.OMXDB_SUCCESS:A1[A9]=AN.ERR_NONE;break;case a.OMXDB_EXPIRED:A1[A9]=AN.ERR_KEY_EXPIRED;break;case a.OMXDB_KEY_DOES_NOT_EXIST:case a.OMXDB_INSTANCE_DOES_NOT_EXIST:A1[A9]=AN.ERR_KEY_NOT_SET;break;case a.OMXDB_INVALID_KEY:A1[A9]=AN.ERR_KEY_INVALID;break;case a.OMXDB_FAILURE:case a.OMXDB_LOWER_VERSION:case a.OMXDB_BUSY:A1[A9]=AN.ERR_KEY_FAILURE;break;default:A1[A9]=AN.ERR_KEY_FAILURE;break;}if(Az[A4].errorCode!==a.OMXDB_SUCCESS){B.stat("OM","ERR:getAppData:"+Az[A4].errorCode);A8.push(A9);}}var A0=Ax.result.totalCount,Ay=Ax.result.returnCount;if((Ay+Ao)<A0){Ar.pageInfo={oPagedData:A5,oPagedVer:A6,oPagedErr:A1,iOffset:Ao+Ay,keyErrors:A8};c(Ar.$cmd,Av,Ar);return;}var BA={data:A5,version:A6,errorCode:A1,totalCount:A0};if(A8.length){BA.warn=AN.ERR_GET_DATA;BA.errorMsg="Errors in key(s): "+A8.join(", ");}K(Av,BA);}function Ap(Ax){var A0=(Ax.fault?Ax.fault:Ax.body.error)||{},Az=A0.code;Az=!Az||AH.isHttpError(Az)?Ax.status:Az;B.stat("OM","ERR:getAppData:"+Az);var Ay={error:AN.ERR_GET_DATA,errorMsg:A0.message||""};K(Av,Ay,true);}for(An in Aq){Am.push("_APP_"+Aq[An]);}Al={method:"GetExtensionData",params:[{query:{key:Am,extensionId:Aj||Au[0],instanceId:Au[1]},maxReturn:Number(20),offset:Ao}],id:"123456789"};Y="/ws/mailPreferences/v1/jsonrpc";At={success:As,failure:Ap,responseType:"json",suppressCodes:["*"],exceptCodes:[401,402,999]};Aw=AU.request(Y,x.JSON.stringify(Al),At,"POST");Aw.addUrlParam("appid",j);Aw.send();}function P(Y,Aj){AX(Y.instanceid,Y,Aj);}function AX(Aj,At,Ap){var An=Ap.keys,As=Aj.split("."),Ao=[],Au,Al;function Ar(Av){K(At,v,true);}function Am(Av){var Ay=(Av.fault?Av.fault:Av.body.error)||{},Ax=Ay.code;Ax=!Ax||AH.isHttpError(Ax)?Av.status:Ax;B.stat("OM","ERR:removeAppData:"+Ax);var Aw={error:AN.ERR_REMOVE_DATA,errorMsg:Ay.message||""};K(At,Aw,true);}for(Al in An){Ao.push("_APP_"+An[Al]);}var Ak={method:"DeleteExtensionData",params:[{query:{key:Ao,extensionId:As[0],instanceId:As[1]}}],id:"123456789"},Y="/ws/mailPreferences/v1/jsonrpc",Aq={success:Ar,failure:Am,responseType:"json",suppressCodes:["*"],exceptCodes:[401,402,999]};Au=AU.request(Y,x.JSON.stringify(Ak),Aq,"POST");Au.addUrlParam("appid",j);Au.send();}function W(Y,Aj){AZ(Y.instanceid,Y,Aj.profile);}function G(Y,Aj){AS(Y.instanceid,Y,Aj.profile,Aj.params);}function R(Y,Aj){AR(Y.instanceid,Y,Aj.profile);}function F(Y,Aj){Ag(Y.instanceid,Y,Aj.profile);}function q(As,Al,Ak){var Aq,Am,Ar=As.appid,Aj=AD.getProperty(As.appid,"main_id"),An=Aj?Aj+"."+As.instanceid.split(".")[1]:As.instanceid,Ap=N(An,Al);function Ao(At,Aw){var Av=AD.getProperty(Ar,"omprofile"),Au=p.ApplicationList.parseOmProfile(At.body.cache);if(Av[Ak]===Au[Ak]){if(!AV.currentProfile[An]){AV.currentProfile[An]={};}AV.currentProfile[An][Ak]=Av[Ak];}Ap.refresh=false;
x.Array.each(Ap.backlog,function(Ax){Ac.apply(this,Ax);});Ap.backlog=[];}function Y(At,Au){x.Array.each(Ap.backlog,function(Av){K(Av[0],h(At));});Ap.refresh=false;Ap.backlog=[];}Aq=AH.getBaseCallback("openmail.app.auth.login.complete",Ao,Y);Am={crumb:NeoConfig.om.crumb,instance:An,profile:Al};AU.request(AH.getUrlForModule(Aq.method),Am,Aq,"GET",null,true);}function AL(Y,Aj){var Ao=Aj.appid,Ak=AD.getProperty(Ao,"main_id"),Am=Ak?Ak+"."+Aj.instanceid.split(".")[1]:Aj.instanceid,Al=AD.getProperty(Ao,"omprofile"),An=AV.currentProfile[Am];if(!(Al&&Al[Y])){return w.SCOPE_NOT_EXIST;}if(!(An&&An[Y])){return w.SCOPE_MISMATCH;}if(Al[Y]!==An[Y]){return w.SCOPE_MISMATCH;}return;}function Ac(As,Ao){var Ak=Ao.profile,Y=AD.getProperty(As.appid,"main_id"),An=Y?Y+"."+As.instanceid.split(".")[1]:As.instanceid,Ap=N(An,Ak),At,Au,Am;if(Ak!=="_openmail_internal"){return;}if(Ap.refresh){Ap.backlog.push([As,Ao]);}Am=AL("email-r",As);if(Am===w.SCOPE_MISMATCH){function Aq(){Ap.backlog.push([As,Ao]);Ap.refresh=true;q(As,Ak,"email-r");}function Ar(Av){var Ax="User authorization denied",Aw={error:AN.ERR_AUTH,errorMsg:Ax};K(As,Aw);}At={source:"getauthparameters",callback:Ar};if(AD.isNoDisclaimer(As.appid)){q(As,Ak,"email-r");}else{x.use("om-controller-addremoveapp",function(Av){p.AddRemoveApp.showLegal(As.appid,At,Aq);});}return;}if(Am===w.SCOPE_NOT_EXIST){var Aj="Authorization service ["+Ak+"] does not exist for this application",Al={error:AN.ERR_AUTH,errorMsg:Aj};K(As,Al);return;}Au={user:{email:NeoConfig.userDataObj.userSendPref.defaultFromAddress,name:NeoConfig.userDataObj.userSendPref.defaultFromName}};K(As,Au);}function b(Y,Aj){J(Y,Y.cbid,Aj.profile,Aj.url,Aj.method,Aj.parameters,Aj.body,Aj.headers,Aj.dataformat,Aj.rewrite);}var t={},l={error:AN.ERR_AUTH};function N(Y,Ak){var Aj=Y+"_"+Ak;if(undefined===t[Aj]){t[Aj]={backlog:[],refresh:false};}return t[Aj];}function AZ(Y,Aj,Ak){var Ap,An,Al=N(Y,Ak);function Am(Ar,At){var Av,Aq,As;try{Av=Ar.body;if(Av.cache!==undefined){Al.cache=Av.cache;if(Av.version!==undefined){Al.version=Av.version;}}else{delete Al.cache;delete Al.version;}Aq={status:Av.status};if(Av.data){Aq.info=Av.data;}K(Aj,{data:Aq});}catch(Au){As={error:AN.ERR_AUTH,errorMsg:Au.toString()};K(Aj,As);}}function Ao(Aq,Ar){K(Aj,h(Aq));}Ap=AH.getBaseCallback("openmail.app.auth.status",Am,Ao);An={crumb:NeoConfig.om.crumb,instance:Y,profile:Ak};AU.request(AH.getUrlForModule(Ap.method),An,Ap,"GET",null,true);}function h(Y){var Ak=Y.fault,Aj={error:AN.ERR_AUTH,errorMsg:Ak.message,errorDetail:{errorCode:Ak.code,detail:Ak.detail,httpStatus:Y.status,httpStatusTxt:Y.statusText}};return Aj;}function AS(Ao,Aq,Ak,Al){var Ap,Aj,An=N(Ao,Ak);if(!Al){Al={};}function Am(As,Au){var Aw,Ar,At;try{Aw=As.body;if(Aw.cache!==undefined){An.cache=Aw.cache;if(Aw.version!==undefined){An.version=Aw.version;}}else{delete An.cache;delete An.version;}Ar={};Ar.data={url:Aw.data};K(Aq,Ar);}catch(Av){At={error:AN.ERR_AUTH,errorMsg:Av.toString()};K(Aq,At);}}function Y(Ar,As){K(Aq,h(Ar));}Ap=AH.getBaseCallback("openmail.app.auth.login.url",Am,Y);Aj={crumb:NeoConfig.om.crumb,instance:Ao,profile:Ak,params:x.JSON.stringify(Al)};AU.request(AH.getUrlForModule(Ap.method),Aj,Ap,"GET",null,true);}function AR(Y,Aj,Ak){var Ap,An,Al=N(Y,Ak);function Am(Aq,As){var Aw,Au,At,Ar;try{Aw=Aq.body;if(Aw.cache!==undefined){Al.cache=Aw.cache;if(Aw.version!==undefined){Al.version=Aw.version;}}else{delete Al.cache;delete Al.version;}Au={};if(Aw.data){Au.info=Aw.data;}At={};At.data=Au;K(Aj,At);}catch(Av){Ar={error:AN.ERR_AUTH,errorMsg:Av.toString()};K(Aj,Ar);}}function Ao(Aq,At){var Av,Ax,Ar={},Au,As,Aw;if(Ak==="_yahoo_internal"){Av=Y.split(".")[0];Ax=AD.get(Av);Ar.appName=Ax.name;}K(Aj,h(Aq));}Ap=AH.getBaseCallback("openmail.app.auth.login.complete",Am,Ao);An={crumb:NeoConfig.om.crumb,instance:Y,profile:Ak};if(Al.cache){An.cache=Al.cache;}if(Al.version){An.version=Al.version;}AU.request(AH.getUrlForModule(Ap.method),An,Ap,"GET",null,true);}function Ag(Y,Aj,Ak){var Ap,An,Al=N(Y,Ak);function Am(Aq,Ar){delete Al.cache;delete Al.version;K(Aj,{});}function Ao(Aq,Ar){K(Aj,h(Aq));}Ap=AH.getBaseCallback("openmail.app.auth.revoke",Am,Ao);An={crumb:NeoConfig.om.crumb,instance:Y,profile:Ak};AU.request(AH.getUrlForModule(Ap.method),An,Ap,"GET",null,true);}function o(Ap,Aj,Am,Ak){var Aq,Al,Ao=N(Ap,Aj);function An(Ar,Au){var At,As,Aw,Av=Ar.body;if(Av.cache!==undefined){Ao.cache=Av.cache;if(Av.version!==undefined){Ao.version=Av.version;}}else{delete Ao.cache;delete Ao.version;}Ao.refresh=false;At=Ao.backlog;for(As in At){Aw=At[As];J.apply(this,Aw);}Ao.backlog=[];}function Y(Ar,Av){var Au,At,Ax,As={},Aw;if(Aj==="_yahoo_internal"){Aw=Ap.split(".")[0];Ax=AD.get(Aw);As.appName=Ax.name;}Au=Ao.backlog;for(At in Au){K(Au[At][0],l);}Ao.backlog=[];Ao.refresh=false;}Aq=AH.getBaseCallback("openmail.app.auth.login.complete",An,Y);Al={crumb:NeoConfig.om.crumb,instance:Ap,profile:Aj};if(!Am){if(Ao.cache){Al.cache=Ao.cache;}if(Ao.version){Al.version=Ao.version;}}if(Ak){Al.install_token=Ak;}AU.request(AH.getUrlForModule(Aq.method),Al,Aq,"GET",null,true);}function J(Ax,Al,Ao,Ak,Y,Ap,Aq,An,Ar,Au){var Aw,Am,Av=Ax.instanceid,At=N(Av,Ao);if(At.refresh){At.backlog.push([Ax,Al,Ao,Ak,Y,Ap,Aq,An,Ar,Au]);}function As(Az,A1){var A3,Ay,A0;try{A3=Az.body;if(A3.cache!==undefined){At.cache=A3.cache;}if(A3.status==="complete"){K(Ax,{data:A3.data});return;}Ay=A3.data;if(AW(An)){Ay.url=AM(Ay.url,f(Ay.params));e(Ax,Al,Ay.url,Y,Aq,An,Ar);}else{e(Ax,Al,Ay.url,Y,Ay.params,An,Ar);}}catch(A2){A0={error:AN.ERR_AUTH,errorMsg:A2.toString()};K(Ax,A0);}}function Aj(A2,A4){var Ay=A2.body,A0,A6={},A5,A3,Az,A1;if(Ay&&Ay.status==="408"){At.backlog.push([Ax,Al,Ao,Ak,Y,Ap,Aq,An,Ar,Au]);if(!At.refresh){At.refresh=true;setTimeout(function(){o(Av,Ao);},500);}}else{if(Ao==="_yahoo_internal"&&Ay&&(Ay.status==="407"||Ay.status==="410")){A0=function(A7){var A9="User authorization denied",A8={error:AN.ERR_AUTH,errorMsg:A9};B.stat("OM","ERR:callAuthWebService:"+A9);K(Ax,A8);};A6={source:"signcall",callback:A0};A5=function(A7){At.backlog.push([Ax,Al,Ao,Ak,Y,Ap,Aq,An,Ar,Au]);
At.refresh=true;var A8=true;setTimeout(function(){o(Av,Ao,A8,A7);},500);};if(AD.isNoDisclaimer(Ax.appid)){A5(null);}else{x.use("om-controller-addremoveapp",function(A7){p.AddRemoveApp.showLegal(Ax.appid,A6,A5);});}}else{B.stat("OM","ERR:callAuthWebService:"+A2.fault.message);K(Ax,h(A2));}}}Aw=AH.getBaseCallback("openmail.app.auth.sign",As,Aj);Am={crumb:NeoConfig.om.crumb,instance:Av,profile:Ao,url:Ak,method:Y,params:x.JSON.stringify(Ap),body:Aq||""};if(An){Am.headers=x.JSON.stringify(An);}if(At.cache){Am.cache=At.cache;}if(Au&&Au.proxy&&Au.url){Am.rewrite=x.JSON.stringify(Au);}if(At.version){Am.version=At.version;}AU.request(AH.getUrlForModule(Aw.method),Am,Aw,"GET",null,true);}function z(Y,Al){var Ak={warn:"openmail.Errors.ERR_VALIDATION_FAILURE"};var Am=function(){x.fire("newMessage",{forceNew:true,cbfn:function(Av,Ao){var Ar,At=Av.get("isRichText");if(Al.appid){Av.appid=Al.appid;}var Aq=function(Ay){var Az=[],Ax=[];if(AE.isArray(Ay)){Ax=x.clone(Ay);}else{Az=Ay.split(",");x.Array.each(Az,function(A1,A0,A2){if(A1){Ax.push({email:A1});}});}return Ax;};var As=function(Ay,Az){Av.set("content",Ay);var Ax=v;if(Az){Ax={warn:AN.ERR_VALIDATION_FAILURE};}Ax.instance=Av._yuid;K(Y,Ax,true);};var Aw=function(Ay,Ax){var Az=n.escapeHtml(Ax||"")||"";As(Az,true);};var Ap=function(Ax){Al.to=Al.to||"";Al.cc=Al.cc||"";Al.subject=Al.subject||"";Ax.to=Aq(Al.to);Ax.cc=Aq(Al.cc);if(!x.Lang.isUndefined(Al.bcc)&&!x.Lang.isNull(Al.bcc)){Ax.bcc=Aq(Al.bcc);}Ax.subject=Al.subject;return Ax;};var Au=Ap(Av.get("header"));Av.set("header",Au);if(Al.html&&At){AK(Al.body,As,Aw,Al,true);}else{Ar=n.escapeHtml(Al.body||"");As(Ar||"");}},postRender:function(Ao,Aq){var Ap=Al.attachments;if(Ap&&Ap.length){An(Ap,Ao);}}});};var An=function(Ar,As){var Aw=[],Au,Av=x.Lang.isObject;function At(Ay){var Ax={filename:Ay.filename||"",size:{original:Math.max(0,parseInt(Ay.size||0,10))},state:{uploaded:true,processed:true},original:{partId:Ay.partId,mid:Ay.mid,fid:Ay.fid,tnef:Ay.tnef||""}};return Ax;}function Ap(Ax){return Av(Ax)&&Ax.mid&&Ax.fid&&Ax.partId;}for(var Aq=0,Ao=Ar.length;Aq<Ao;Aq++){Ap(Ar[Aq])&&Aw.push(At(Ar[Aq]));}if(Aw.length){As.cdo._addAttachments(Aw);Au=As.cdo.get("origin");Au.action="om:app";As.cdo.set("origin",Au);}};var Aj=x.common.persist.UserData.get("userUIPref.useRichText");if((Aj==="plain")&&Al.html){x.use("common-ui-dialog-helper",function(Ao){Ao.common.ui.DialogHelper.confirm({hd:strings.str_om_switch_to_rich_text_title,bd:strings.str_om_switch_to_rich_text_body,suppressActive:true},{ok:{handler:function(){Ao.common.persist.UserData.set("userUIPref.useRichText","dynamic");Am();}},cancel:{handler:function(){Al.body=Ao.mail.Controller.Compose.convertHTMLToPlain(Al.body);Am();}}});});}else{Am();}}function i(Y,Aj){var Ak={warn:"openmail.Errors.ERR_VIEW_EXISTS"};x.use("om-controller-views",function(Ao){var Ap=p.Views,Am=Ap.getInternalUserViewId(Y.appid,Aj.id),Al=m.get(Am),An=Al?Ak:v;Ap.openView(Y.appid,Y.instanceid,Am,Aj.view,Aj.viewType,Aj.target,Aj.context||null,Aj.parameters||null,Aj.width,Aj.height,Aj.ttl||0,Aj.title||"","api/openView",Y,null,null,null,Aj.options||{},function(Aq){K(Y,Aq,true);});});}function AA(Y,Aj){x.use("om-controller-views",function(An){var Ao=p.Views,Am={},Al=Aj.id?Ao.getInternalUserViewId(Y.appid,Aj.id):Y.id,Ak=m.get(Al);if(Ak){Ao.closeView(Al);K(Y,v,true);}else{Am.error=AN.ERR_VIEW_NOT_FOUND;Am.errorMsg="The application does not have a view named '"+Al+"'";K(Y,Am,true);}});}function H(Y,Aj){Aj=Aj||{};Aj.folderId="Draft";X(Y,Aj);}function X(Ar,Am){var Ak=x.mail.model.DataStore,Y=x.mail.Controller.Messages,Ao=Ak.Messages,Ap,Aj;Am=Am||{};Ap=Am.messageId;Aj=Am.folderId;try{if(!Ak.Folders.getByName(Aj)){K(Ar,{error:AN.ERR_UNDEFINED,errorMsg:"Invalid folder id"});}else{function Aq(){K(Ar,{error:AN.ERR_UNDEFINED,errorMsg:"Unable to load message"});}function An(){Y.get({fid:Aj,msg:Ao.get(Aj,Ap)},{success:function(){x.fire("openMessage",{fid:Aj,msg:Ap});},failure:Aq});}if(Ao.get(Aj,Ap)){An();}else{Y.list({fid:Aj,offsetMid:Ap,numInfo:1,startInfo:0},{success:function(As){Ao.set(Aj,As.messageInfo);An();},failure:Aq});}}}catch(Al){K(Ar,{error:AN.ERR_UNDEFINED});}}function AQ(Am,Y,Aj,Al){function Ao(Ap){Am.label=encodeURIComponent(Ap);delete Am.htmlLabel;Ak();}function Ak(){Y.asyncCount--;if(!Y.asyncCount){x.fire("om:updateSingleFolder",{ctx:Aj,config:Al});K(Aj,v,true);}}var An=false;if(Am.label){Am.label=n.escapeHtml(Am.label);}else{if(Am.htmlLabel){Am.label=n.escapeHtml(Am.htmlLabel);An=true;Y.asyncCount++;AK(Am.htmlLabel,Ao,Ak);}}if(Am.icon){delete Am.icon;}if(Am.tooltip){Am.tooltip=n.escapeHtml(Am.tooltip);}return An;}function L(Aj,Ak){var Al,An,Am=false;var Y={asyncCount:0};Am|=AQ(Ak,Y,Aj,Ak);if(Ak.subFolders){for(Al=0,An=Ak.subFolders;Al<An.length;Al++){Am|=AQ(An[Al],Y,Aj,Ak);}}return Am;}function AP(Y,Aj){if(!L(Y,Aj)){x.fire("om:updateSingleFolder",{ctx:Y,config:Aj});K(Y,v,true);}}function AT(Av,Aq){var Au=Av.appid,Ak=Av.instanceid,At=Av.id,Ar=AD.get(Au).name,Ao=V.getEventName(Ak,"app.jserror",At),Am=Aq.message,Aj=Aq.url||Aq.pageurl,Al=Aq.linenumber||Aq.errorcode,Y=AV.MessageReadRunList.getAll(),As,An,Ap=false;B.stat("OM","API:JSERROR");B.stat("OM","API:JSERROR:"+Au.toLowerCase());for(As in Y){x.fire("message.read.jserror"+As);}if(d.getByEventName(Ak,At,Ao)){x.fire(Ao,{app:Au,instance:Ak,appName:Ar,message:Am,url:Aj,lineno:Al});Ap=true;}An=['openapi: app "',Ar,'" ',(Ap?"handled":"didn't handle")," a JS error. ","line:",Al,"/ msg:",Am,"/ url: ",Aj].join("");V.log(An);if(NeoConfig.log_error_yapache==1){x.use("common-utils-error",function(Aw){Aw.common.Utils.error.report(An,1);});}}var AF=new V.LookupList("crumb.update","app.uninstalled","mail.signout","contacts.sendsms","contacts.sendim","contacts.changed","tab.changed","social.statuschanged","chats.sendim","chats.sendsms");function AC(Ap,Al){var Ar=Ap.appid,Y=Al.event,Ao=Al.crumb,Ak=Ap.instanceid,Aj=Ap.id,An=V.getEventName(Ak,Y,Aj),Aq=(Y===An);if((Y in AF||V.Event.isMailEvent(Y))&&NeoConfig.om.crumb!==Ao){return;}function Am(At){At.$keep=true;try{for(var As in d.getByInstId(Ak)){K(d.getByEventName(Ak,As,An),At);
}}catch(Au){return;}At.handled=true;}if(!Aq){x.detachAll(An);}d.set(Ap,Am,Ak,Aj,An);x.on(An,Am);x.fire(An+"registered",An,Al);}function Aa(Y,Aj){x.use("om-controller-views",function(An){var Ao=p.Views,Ak=Ao.getInternalUserViewId(Y.appid,Aj.id),Am=Ak&&m.get(Ak),Al=Am&&Am.get("tab");if(Am&&Al){Am.set("tabCloseMessage",Aj.msg);Al.cfg.widget.set("canClose",!Aj.msg);}});}function A(Y){return Number(AD.get(Y).config["@attributes"].version);}function D(Y,Aj,Al,Am){Am=Am||x.JSON.stringify(Aj);try{return YUI.om.Iframe.send(Y.proxy,Al,["cmd=",Y.skipURIEncode?Am:encodeURIComponent(Am)].join(""),V.getAppSignature(Y.appid),Y.version,Y.id);}catch(Ak){V.log("returnSend:YUI.om.Iframe.send error:"+Ak.message||"unknown");B.stat("OM",["ERR:returnSend:",Y.appid,":",Ak.message||"unknown"].join(""));}}function K(Y,Aj,Al,Am){var Ak;if(!Y){return;}if(Y.restoreCallerContext){Y.restoreCallerContext();}if(Aj){if(Y.cbid===null){if(Al){return;}else{throw new Error("returnAPI: cannot return value, no callback id set.");}}Aj.$cbid=Y.cbid;Aj.$apiVersion=Y.apiVersion;if(!x.UA.gecko&&Y.id&&frames[Y.id]){return u.returnSend(Y,Aj,"frames['"+Y.id+"']",Am);}else{for(Ak=frames.length-1;Ak>=0;--Ak){if(frames[Ak]===Y.iframe.contentWindow){return u.returnSend(Y,Aj,"frames["+Ak+"]",Am);}}}V.log("returnAPI: couldn't find return context iframe");B.stat("OM","ERR:returnAPI:"+Y.appid);}}function k(Ak,Y,Aj){switch(Ak){case"getParameters":r[Ak](Y,Aj,K);break;default:r[Ak](Y,Aj);}}function c(Ak,Y,Aj){var An,Al,Am=Ak;Ak=Ak.toLowerCase();if(!((Ak==="callwebservice")&&Aj&&Aj.url&&(Aj.url==="apps://"))){An="API:"+Ak;Al=An+":"+(Y.appid||"gallery").toLowerCase();B.stat("OM",An);B.stat("OM",Al);}V.log(Ak,AD.getAppName(Y.appid)+".API");k(Am,Y,Aj);}x.on("windowresize",V.onIdle(function(){x.fire(V.getEventName(null,"browser.resize"),{});},E));x.mix(u,{returnAPI:K,returnSend:D,publicAPIs:r,enforceRules:c,setListener:AC,upgrade:AO,validateFolderConfig:L,handleFlashRequired:O},true);p.Webservice.createWebServiceObject(K,function(Y){if(!Y){Af=true;}while(AB.length>0){(AB.shift())();}});},"1.0.0",{requires:["om-controller-base","om-controller-webservice","om-common-constants","om-common-net-session","om-common-utils","om-model-datastore","om-common-errors","common-net-sessionmgr","common-utils","json","rocket-stats"]});var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var YUI;if(typeof YUI==="undefined"){(function(){var e=".",b=Object.prototype.hasOwnProperty,d=Object.prototype.toString,c={"undefined":"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"},f,a=function(j,i){var h=typeof j;return(j&&(h==="object"||(!i&&(h==="function"||f.Lang.isFunction(j)))))||false};f={namespace:function(){var k=arguments,q=this,n=0,m,p,h;for(;n<k.length;n++){h=k[n];if(h.indexOf(e)){p=h.split(e);for(m=(p[0]=="YAHOO")?1:0;m<p.length;m++){q[p[m]]=q[p[m]]||{};q=q[p[m]]}}else{q[h]=q[h]||{}}}return q},add:function(h,i){if(i){i(f)}},use:function(){var h=arguments[arguments.length-1];if(typeof h==="function"){h(f)}},log:function(){},merge:function(){var k=arguments,m=0,j=k.length,h={};for(;m<j;++m){f.mix(h,k[m],true)}return h},Object:{_hasEnumBug:!{valueOf:0}.propertyIsEnumerable("valueOf"),_forceEnum:["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"]},mix:function(h,j,q,k,n,r){var o,u,t,m,v,p,s;if(!h||!j){return h||f}if(n){if(n===2){f.mix(h.prototype,j.prototype,q,k,0,r)}t=n===1||n===3?j.prototype:j;s=n===1||n===4?h.prototype:h;if(!t||!s){return h}}else{t=j;s=h}o=q&&!r;if(k){for(m=0,p=k.length;m<p;++m){v=k[m];if(!b.call(t,v)){continue}u=o?false:b.call(s,v);if(r&&u&&a(s[v],true)&&a(t[v],true)){f.mix(s[v],t[v],q,null,0,r)}else{if(q||!u){s[v]=t[v]}}}}else{for(v in t){if(!b.call(t,v)){continue}u=o?false:b.call(s,v);if(r&&u&&a(s[v],true)&&a(t[v],true)){f.mix(s[v],t[v],q,null,0,r)}else{if(q||!u){s[v]=t[v]}}}if(f.Object._hasEnumBug){f.mix(s,t,q,f.Object._forceEnum,n,r)}}return h},Lang:{isString:function(h){return typeof h==="string"},isFunction:function(h){return f.Lang.type(h)==="function"},type:function(h){return c[typeof h]||c[d.call(h)]||(h?"object":"null")}}};YUI=function(){return f};for(var g in f){if(f.hasOwnProperty(g)){YUI[g]=f[g]}}})()}if(typeof YAHOO==="undefined"||!YAHOO){var YAHOO={util:{}}}if(typeof YAHOO.util==="undefined"||!YAHOO.util){YAHOO.util={}}if(!YAHOO.util.CrossFrame){YAHOO.util.CrossFrame=(function(){var k=/^frames\[(\d+)\]$/,h=/^frames\[['"]([a-zA-Z0-9-_]+)['"]\]$/;var m,e,g,o,i,f,c,b,n,a=YUI;if(window.postMessage||document.postMessage){c=function(p,s,q){var r;if(n(q||"1.0.15","1.0.15")<1){r=[i(s),i(p)].join("|")}else{r=[i(q),i(s),i(p)].join("|")}return r};b=function(r){var q=r.split("|"),p;for(p=q.length-1;p>=0;--p){q[p]=f(q[p])}if(q.length==2){return{sig:q[0],body:q[1]}}else{if(q.length==3){return{version:q[0],sig:q[1],body:q[2]}}else{return null}}};i=function(p){return p.replace(/\|/g,"&c124;")};f=function(p){return p.replace(/&c124;/g,"|")}}else{c=function(p,u,q,s,r){var t;q=q||"1.0.15";if(n(q,"1.0.15")<1){t=[u,p.replace(/\&/g,"&c38;").replace(/\"/g,"&c34;").replace(/\'/g,"&c39;").replace(/\\/g,"&c92;").replace(/\0/g,"&c0;").replace(/\n/g,"&c10;").replace(/\r/g,"&c13;")].join("|")}else{if(n(q,"1.1.9")<0){t=[i(q),i(u),i(p)].join("|")}else{t=[i(q),i(u),i(p),i(s),i(r)].join("|")}}return t};b=function(q){var p=q.split("|");if(p.length===2){return{sig:p[0],body:p[1].replace(/&c13;/g,"\r").replace(/&c10;/g,"\n").replace(/&c0;/g,"\0").replace(/&c92;/g,"\\").replace(/&c39;/g,"'").replace(/&c34;/g,'"').replace(/&c38;/g,"&")}}else{if(p.length===3){return{version:f(p[0]),sig:f(p[1]),body:f(p[2])}}else{if(p.length===5){return{version:f(p[0]),sig:f(p[1]),body:f(p[2]),target:f(p[3]),url:f(p[4])}}else{return null}}}};i=function(p){return escape(p.replace(/\&/g,"&c38;").replace(/\"/g,"&c34;").replace(/\'/g,"&c39;").replace(/\\/g,"&c92;").replace(/\0/g,"&c0;").replace(/\n/g,"&c10;").replace(/\r/g,"&c13;").replace(/\//g,"&c47;").replace(/\@/g,"&c64;").replace(/\+/g,"&c43;"))};f=function(p){return unescape(p).replace(/&c43;/g,"+").replace(/&c64;/g,"@").replace(/&c47;/g,"/").replace(/&c13;/g,"\r").replace(/&c10;/g,"\n").replace(/&c0;/g,"\0").replace(/&c92;/g,"\\").replace(/&c39;/g,"'").replace(/&c34;/g,'"').replace(/&c38;/g,"&")}}n=function(t,r){var s=typeof t==="string",q=typeof r==="string";if(!s||!q){return s&&!q?1:(!s&&q?-1:0)}t=t.split(".");r=r.split(".");if(t.length!==3||r.length!==3){throw new Error("Invalid version format")}var v=0,u=0;for(var p=0;p<3;p++){v=parseInt(t[p],10);u=parseInt(r[p],10);if(v!==u){return(v>u)?1:-1}}return 0};e=function(p,q){if(Object.prototype.hasOwnProperty){return p.hasOwnProperty(q)}return typeof p[q]!=="undefined"&&p.constructor.prototype[q]!==p[q]};g=function(v){var w,t,y,x,u,q;w={};t=v.split("&");for(u=0,q=t.length;u<q;u++){x=t[u].indexOf("=");w[t[u].substr(0,x)]=decodeURIComponent(t[u].substr(x+1))}return w};m=function(v){var s=v.split("."),t,r,q,u;v=window;for(r=0,q=s.length;r<q;r++){u=s[r];if(u==="parent"){v=v.parent}else{if(u==="opener"){v=v.opener}else{if(u==="top"){v=v.top}else{if((t=k.exec(u)||h.exec(u))){v=v.frames[t[1]]}else{throw new Error("Invalid Target: "+v)}}}}}return v};o=function(){var u,t,r,q,p,w=g(window.location.hash.substr(1)),v=b(window.name);if(w.target){t=m("parent."+w.target);q=w.url}else{t=m("parent.opener."+v.target);q=v.url}if(v&&t&&q){r=q.split("/")[2];p=v.version;u=(t.YUI&&t.YUI.util&&t.YUI.util.CrossFrame)?t.YUI.util.CrossFrame:t.YAHOO.util.CrossFrame;try{if(navigator.userAgent.indexOf("Firefox")>-1){t.setTimeout(function(){u._receive([v.sig,v.body].join("|"),r,q,p)},0)}else{u._receive([v.sig,v.body].join("|"),r,q,p)}}catch(s){}}else{throw new Error("Missing required params")}};function d(r,s,q,p){a.util.CrossFrame._receive(r,s,q,p)}var j;j={proxyReceive:o,parseTarget:m,constructMessage:c,deconstructMessage:b,escapeAttr:i,unescapeAttr:f,compareVer:n,_receive:d};return j})();if(typeof YUI!=="undefined"&&YUI){YUI.namespace("util.CrossFrame");YUI.add("omCrossframe",function(a){},"1.0.0",{requires:[]});(function(d){var u="1.1.16",p=YUI.util.CrossFrame;var h="OM_VBS_Wrapper",b="OM_VBS_GetWrapper",s="OM_VBS_HandleMessage",m="OM_VBS_CreateChannel",j,v=window.location.toString(),i,x,n,y;i=YAHOO.util.CrossFrame.parseTarget;x=YAHOO.util.CrossFrame.compareVer;function o(D,C,B,e){if(D&&D.addEventListener){D.addEventListener(C,B,e)}else{if(D&&D.attachEvent){D.attachEvent("on"+C,B)}}}function g(e){if(e.stopImmediatePropagation){e.stopImmediatePropagation()}else{if(e.stopPropagation){e.stopPropagation()}}e.cancelBubble=true}n=function(D){var e=(d.Lang.isString(D))?D.replace(/#$/,""):false,C=document.getElementsByTagName("iframe"),B;for(B=0,l=C.length;B<l;B++){if(C[B].src.replace(/#$/,"")===e||C[B].contentWindow.location===D){return C[B]}}return null};y=function(D){var B=(typeof D==="object")&&(D!==null)&&(typeof D.sig==="string")&&(typeof D.body==="string")&&(D.sig.length>2)&&(D.body.length>0);if(B){try{if(x(D.version||"1.0.15","1.0.15")<1){}else{B=(x(D.version,D.version)===0)}}catch(C){B=false}}return B};var z,q,k,a,t,A,r,f,c;k=YAHOO.util.CrossFrame.constructMessage;a=YAHOO.util.CrossFrame.deconstructMessage;t=YAHOO.util.CrossFrame.escapeAttr;A=YAHOO.util.CrossFrame.unescapeAttr;if(window.postMessage||document.postMessage){r=!window.postMessage;o(window,"message",function(B){var C,D,E,G;B=B||window.event;try{G=a(B.data);if(y(G)){D=B.origin;E=D.split("/")[2];C=n(B.source.location);if(self===top){g(B)}p.fire("receiveMessage",[G.sig,G.body].join("|"),E,D,C,G.version)}else{}}catch(F){d.log("crossframe.js:onMessageListener: error msg["+F.message+"]")}},false);z=function(E){var B,D,C=i(E.target),e=E.version||u;if(!C){return false}if(r){C=C.document}D=k(E.message,E.sig||"",e);C.postMessage(D,E.proxy);E.handler.call(window);return true}}else{if(window.ActiveXObject){j={};window[s]=function(e,H,I,F){var E=arguments.length,D,C,B,G;window.setTimeout(function(){try{if(E===1){D=JSON.parse(e);e=D.uri;H=D.sig;I=D.message;F=D.version}else{e+="";H+="";I+="";F+=""}C=n(e);B=e.split("/")[2];p.fire("receiveMessage",[H,I].join("|"),B,e,C,F)}catch(J){}},0)};window[m]=function(e,B){j[e]=B};vbscript=["Class "+h+"\n ","Private m_Intended\n","Public Sub SetIntendedName(name)\n ","If isEmpty(m_Intended) Then\n","m_Intended = name\n","End If\n","End Sub\n","Public Sub SendMessage(data)\n ",s+"(data)\n","End Sub\n","Public Sub SendMessage2(uri, sig, message, version)\n ","Call "+s+"(uri, sig, message, version)\n","End Sub\n","Public Sub CreateChannel(channel)\n ","Call "+m+"(m_Intended, channel)\n","End Sub\n","End Class\n","Function "+b+"(name)\n","Dim wrap\n","Set wrap = New "+h+"\n","wrap.SetIntendedName name\n","Set "+b+" = wrap\n","End Function"].join("");try{window.execScript(vbscript,"vbscript")}catch(w){}}z=function(E){var B,C;E.version=E.version||u;E.sig=E.sig||"";E.uri=v;try{B=E.targetId||"parent";if(B=="parent"){C=j.parent;if(!C&&window.opener&&"CreateChannel" in window.opener){C=window.opener;C.CreateChannel(window[b]("parent"));j.parent=C;window.opener=null}if(C){if("SendMessage2" in C){C.SendMessage2(E.uri,E.sig,E.message,E.version)}else{C.SendMessage(JSON.stringify(E))}E.handler.call(window);return true}}else{if(j[B]){if("SendMessage2" in j[B]){j[B].SendMessage2(E.uri+"",E.sig+"",E.message+"",E.version+"")}else{j[B].SendMessage(JSON.stringify(E))}E.handler.call(window);return true}}}catch(D){}c.send(E)};c=(function(){var e=(function(){var C=0;return function(){return"om_xdm_proxy"+C++}})();q=function(D){function C(){var E=document.getElementById(D);E.getElementsByTagName("iframe")[0].onload=null;if(E.parentNode){E.parentNode.removeChild(E)}E=null}p.mapHandlers[D].call(window);delete p.mapHandlers[D];if(navigator.userAgent.indexOf("Firefox")>-1){setTimeout(C,0)}else{C()}};var B=function(E){if(!document||!document.body){setTimeout(function(){z(E)},20);return}var I=E.proxy,G=E.target,O=E.message,L=E.handler,N=E.sig||"",H=E.version||u;if(!i(G)){L();return false}if(window.ActiveXObject&&x(H,"1.1.9")>=0){var J=new ActiveXObject("htmlfile");J.open();J.parentWindow.opener=window;J.parentWindow.callback=function(){J=null;L()};J.write(["<html><head></head><body>",'<iframe src="',I,'" name="',k(O,N,H,G,v),'"></iframe>',"<script>onload = callback;<\/script>","</body></html>"].join(""));J.close()}else{var K=[I,"#","target=",encodeURIComponent(G)+"&url=",encodeURIComponent(v)].join(""),F,D,C=document.createElement("div"),M=C.style;D=e();p.mapHandlers[D]=L;F=["<iframe onload=\"YAHOO.util.CrossFrame.iframeOnload('",D,'\');" name="',k(O,N,H),'" src="',K,'"></iframe>'].join("");M.width=M.left=M.top=M.height="0";M.overflow="hidden";M.position="absolute";C.id=D;document.body.appendChild(C);C.innerHTML=F}return true};return{send:B}})()}d.mix(p,{_events:{},on:function(e,C){var B=this._events;if(!B[e]){B[e]=[C]}else{B[e].push(C)}},fire:function(C){var E=this._events[C]||[],B=Array.prototype.slice.apply(arguments,[1]);for(var D=E.length;D--;){try{E[D].apply(null,B)}catch(F){}}},send:z,mapHandlers:{},_receive:function(D,E,C,e){var B=n(C);p.fire("receiveMessage",D,E,C,B,e)},initIEFrameTransport:function(e,C){var B;if(window.ActiveXObject&&!window.postMessage){B=window[b](C);e.contentWindow.opener=B}},proxyReceive:YAHOO.util.CrossFrame.proxyReceive},true);YAHOO.util.CrossFrame.iframeOnload=q})(YUI())}}if(typeof YUI!=="undefined"&&YUI&&!(YUI.om&&YUI.om.Iframe)){YUI.namespace("om.Iframe");(function(b){var d=[],f=[],j,c,g,i,e=true,h=YUI.util.CrossFrame;j=function(v,o,m,p,s){var k=v.indexOf("|"),u=v.substr(0,k),t,q,n;v=v.substr(k+1);for(q=0,n=d.length;q<n;q++){t=d[q];if(t.sig){if(!u||(t.sig!==u)){continue}}if(t.filter&&((t.filter.exec&&!t.filter.exec(m))||(t.filter.call&&!t.filter.call(null,m)))){continue}if(t.handler){try{t.handler.apply(t.scope,[{iframe:p,version:s},v.substr(4)])}catch(r){b.log("Exception in user defined handler","om.Iframe","iframe.js")}}}};h.on("receiveMessage",j);c=function(k){if(!k.pattern||!k.pattern.test||!k.handler||!k.handler.call){return false}d.push(k);return true};i=function(o,q,p,m,k,n){f.push({proxy:o,target:q,message:p,handler:g,sig:m,version:k,targetId:n});if(!e){g()}};g=function(){if(!f.length){e=false;return}e=true;h.send(f.shift())};YUI.om.Iframe={listen:c,send:i};function a(k){if(/in/.test(document.readyState)){setTimeout(function(){a(k)},9)}else{k()}}if(window.postMessage||document.postMessage||(top==self)){g()}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",g,false)}else{a(g)}}})(YUI())};YUI.add("om-controller-crossframe",function(C){var M=C.om,E=M.Controller,N=E.extend("Crossframe"),L=E.Openapi,D=M.common.Errors,K=M.common.Utils,F=M.model.DataStore,H=F.Registry,A=false,B=C.common.Utils.rocketstats;function G(R,S,T,P){var O=R.iframe,W=null,V={},Q,U=R.version||"1.0.15";if(K.compareVer(U,"1.0.16")<0&&P){throw new Error("initAPI: bad API, crossframe version");}if(O!==null){W=F.ViewRegistry.get(O.id);V={cbid:S||null,apiVersion:T,version:U,skipURIEncode:P,iframe:O,proxy:O.src.split("/").slice(0,3).join("/")+"/om/xdm_proxy?bn="+NeoConfig.om.xdmproxyVer,widget:W,appid:W&&W.get("appId"),instanceid:W&&W.get("instanceId"),id:W&&W.get("viewId"),parameters:W&&W.get("params")};for(Q=frames.length-1;Q>=0;--Q){if(frames[Q]===O.contentWindow){return V;}}}throw new Error("initAPI: invalid message origin");}function I(V,T){var Q,P,S=false;try{Q=C.JSON.parse(T);S=true;}catch(U){}if(C.Lang.isUndefined(Q)){Q=C.JSON.parse(decodeURIComponent(T));}var O=G(V,Q.$cbid,Q.$apiVersion,S),R=L.publicAPIs[Q.$cmd];if(R){if(!A&&H.isMessenger(O.appid)){A=true;C.fire("Y.om.controller:launchIM:complete");}L.enforceRules(Q.$cmd,O,Q);}else{P={error:D.ERR_UNSUPPORTED_BY_HOST};L.returnAPI(O,P,true);}}function J(R){var P="https?://(?:[a-z0-9]+(-|\\.))?",O="(?:"+K.escapeDots(NeoConfig.om.webcacheHostNet)+")",S="(?:"+K.escapeDots(NeoConfig.om.webcacheHostCom)+")";try{YUI.om.Iframe.listen({pattern:/^cmd=([\s\S]*)$/,handler:R,filter:new RegExp(["^",P,"(?:",O,"|",S,")","(?:/|$)"].join(""))});K.log("INIT Crossframe handler");}catch(Q){K.log("neo:OM:crossframe:setListenerHandler: YUI.om.Iframe missing, check if neo loaded openmail crossframe correctly. message=["+(Q.message||"")+"]");B.stat("OM",["OM:ERR:setListenerHandler",Q.message].join(":"));}}J(I);C.mix(N,{publicHandler:I,setListenHandler:J},true);},"1.0.0",{requires:["om-controller-base","om-common-utils","om-controller-openapi","omCrossframe","rocket-stats"]});YUI.add("om-controller-views",function(E){var e=E.om,L=e.Controller,s=e.common.Errors,g=L.extend("Views"),t=e.common.Utils,v=e.model.DataStore,n=v.Registry,f=v.ViewRegistry,G=v.EventRegistry,V=v.OpenViewLog,j=v.APP_FLAGS,U=E.common.Utils,r=U.substitute,W="om_user_view_id_",l="om_default_view_id_",A=E.Lang,c=E.Array,H=U.rocketstats,K=[NeoConfig.lang?NeoConfig.lang.replace(/-x-.*$/,""):"en-US"],k=NeoConfig.om.intl?NeoConfig.om.intl.replace(/_.*$/,""):"us",O=NeoConfig.om.intl?NeoConfig.om.intl.replace(/^.*_|^.*$/,""):"";function P(w,Y){return W+w+"-"+Y;}function h(w,Y){return l+w+"-"+Y;}function F(w,Y){return h(w,Y)+"_"+new Date().getTime();}function B(w,Y,x){if(x.target_zone==="messagepane"){return F(w,Y);}return x.id?P(w,x.id):h(w,Y);}function b(w){var Y="";if(w.indexOf(W)===0){Y=w.indexOf("-")+1;return w.substring(Y);}return w;}function d(){return"&cb="+(new Date()).getTime();}function J(x,w){var Y=n.get(x);if(Y&&Y[w]){return Y[w];}}function m(AA,x){var Y=n.isInternal(AA),y=J(AA,"status")&j.SANDBOXED,w=(Y&&!y)?NeoConfig.om.webcacheHostCom:NeoConfig.om.webcacheHostNet,AB=(NeoConfig.om.webcacheHostCom.indexOf("yahoo.com")!==-1&&NeoConfig.om.webcacheHostCom.indexOf(".corp.")!==-1),z="-";return NeoConfig.launch_protocol+(!AB?[AA,z,w].join(""):w);}function u(AF,AD,AH,AG){var x,w=NeoConfig.farm?NeoConfig.farm.substring(1):"",z=c.hash(["9323","323","372","6193"]),y=NeoConfig.om.xdmproxyVer,AB=NeoConfig.isFullSSL,AC=n.isInternal(AH),AA=[m(AH,AB),"/om/api/1.0","/openmail.app.invoke"].join(""),AE=[AH,J(AH,"version"),y,NeoConfig.om.intl,NeoConfig.lang,AF,AB?"1":"0"],Y={bn:y,".lang":NeoConfig.lang,".intl":NeoConfig.om.intl,rtl:NeoConfig.isRTL?"1":"0",proxyhost:NeoConfig.servername,sig:t.getAppSignature(AH),vid:b(AG),app:AH,mailver:"neo"};if(w in z){Y.farm=w;}if(AB){Y.proxyssl=1;}x=[AA,"/",AE.join("/"),"#",E.QueryString.stringify(Y),AC?"&crumb="+NeoConfig.om.crumb:""].join("");return x;}function Q(Y){var w=f.get(Y);if(w){t.log("openview: view["+w+"] already running, no need to openView");}return !!w;}function C(AC,AF,AA,AB,z,w,AE,x,Y,y,AD){E.use("om-ui-views-hidden",function(AI){if(Q(AC)){return;}var AH=u(AB,z,AF,AC),AG=new AI.om.ui.views.Hidden({appId:AF,instanceId:AA,viewId:AC,params:AE,url:AH,elementAttributes:y});f.set(AC,AG);AG.on("load",function(){if(AD){AD(AG);}});AG.render();});}function D(AC,AF,AA,AB,z,w,AE,x,Y,y,AD){E.use("om-ui-views-simple","_shared_module_open_mail_application_messagepane",function(AI){if(Q(AC)){return;}var AH=u(AB,z,AF,AC),AG=new AI.om.ui.views.Simple({template:AI.ui.Templates._shared_module_open_mail_application_messagepane,appId:AF,instanceId:AA,viewId:AC,params:AE,url:AH,elementAttributes:y});f.set(AC,AG);if(AD){AD(AG);}});}function X(Y,AA,y,x,w,z,AB){E.use("om-ui-views-folderpane",function(AD){if(Q(Y)){return;}var AC=new AD.om.ui.views.FolderPane({appId:AA,instanceId:y,viewId:Y,params:w.parameters,url:x,height:w.height,hidden:w.hidden,elementAttributes:z});f.set(Y,AC);AC.on("load",function(){if(AB){AB(AC);}});AC.render();AD.on("scroll",t.onIdle(function(){AD.fire(t.getEventName(null,"folderpane.scroll"),{});},200),(NeoConfig.fullPage)?window:"#shellnavigation");});}function S(AC,AG,z,AA,y,w,AF,Y,AE,AB,AH,x,AD){E.use("om-ui-views-panel",function(AJ){if(Q(AC)){return;}var AI=new AJ.om.ui.views.Panel({appId:AG,instanceId:z,viewId:AC,params:AF,url:AA,width:Y,height:AE,elementAttributes:x,options:AH||{}});f.set(AC,AI);AI.on("load",function(){if(AD){AD(AI);}});AI.render.apply(AI,AH.renderParams||[]);});}function N(AC,AG,z,AA,y,w,AF,Y,AE,AB,AI,x,AD){var AH=n.get(AG);E.use("om-ui-views-pod",function(AP){var AN=null,AK,AL,AQ,AM,AO,AJ=new AP.om.ui.views.Pod({appId:AG,instanceId:z,viewId:AC,params:AF,url:AA,width:Y,height:AE,elementAttributes:x,options:AI||{}});f.set(AC,AJ);AJ.on("load",function(){if(AD){AD(AJ);}});if(AI.renderParams){AN=AI.renderParams;}else{AK=AP.one("#wn_container .wn-lyt");if(!AK){return;}AL=false;AM=AK.one('> div > div.pod-fullapp[data-appid="'+AG+'"]');if(!AM){AQ=AP.Object.getValue(AH.settings,["wnp.position"]);if(typeof AQ!=="undefined"){AM=AK.all("> div:not(.hidden)");AM=AM.item(AQ-1);if(AM){AK=AM;AL=true;}}AM=AP.Node.create("<div>");AO="pod_app_user_"+AG;AM.setAttribute("id",AO);if(AL){AK.insert(AM,AK);}else{AK.append(AM);}NeoGV.injectPod({tmpl:"fullapp",data:{pod_templ:"fullapp",pod_id:AO,pod_name:AO,pod_layout:"pod-fullapp",appId:AG,app_name:AB},id:AO});AK=AM.one(">div")||AM;AK.empty();AN=[AK,false];}else{if(!AM.get("parentNode").hasClass("hidden")){AM.empty();AK=AM;AN=[AK,AL];}}}AN&&AJ.render.apply(AJ,AN);});}function T(y,Y,x){var w=G.getByEventName(y,Y,x);if(w){E.detach(x,w.listenerFn);G.del(y,Y,x);}}function I(x,Y){var y=G.getByViewId(x,Y),w;if(y){for(w in y){T(x,Y,w);}}}function R(w){if(!w){U.assert(false);return;}var Y=w.get("viewId"),x=w.get("instanceId");V.del(Y);f.del(Y);I(x,Y);}function q(z,AP,AR,AK,AQ,AT,x,AB,AL,AI,AF,AU,AD,AM,Y,AG,AC,y,AA){H.stat("OM","APP:INVOKE:"+z);V.set(AR,arguments);AP=AP||J(z,"instance");y=y||{};function AS(AV){if(AA){AA(AO);}}var AJ={title:y.elementTitle?U.escapeHtml(y.elementTitle):n.getAppName(z)},AO={},w=[AT],AE=[],AH={appId:z||null,context:x||null,data:AB||{},reason:AD||null,theme:"",user:{cobrand:O,guid:NeoConfig.neoguid,intl:k,lang:K.slice(),bidi:!!NeoConfig.bidi,isRTL:!!NeoConfig.isRTL,useRichText:E.common.persist.UserData.get("userUIPref.useRichText"),theme:"",themeinfo:NeoConfig.theme?{name:NeoConfig.theme.id,css:NeoConfig.theme.url}:{}},version:"2"};if(n.isInternal(z)){AH.instanceId=AP||null;AH.isAMT=NeoConfig.isAMT;AH.urlParams=U.parseQueryString();AH.wssid=NeoConfig.wssid;if(O&&!c.some(AH.user.lang,function(AV){return AV===NeoConfig.lang;})){AH.user.lang.unshift(NeoConfig.lang);}}if(AG){AH.actionType=AG;}try{if(Y&&Y.className&&(Y.className.indexOf("subAppRow")>-1)){AE=Y.id.split("_");AH.index=AE[AE.length-1];}}catch(AN){}switch(AT){case"panel":S(AR,z,AP,u(AK,AQ,z,AR),AQ,x,AH,AL,AI,AU,y,AJ,AS);break;case"pod":N(AR,z,AP,u(AK,AQ,z,AR),AQ,x,AH,AL,AI,AU,y,AJ,AS);break;case"folderpane":y.parameters=AH;X(AR,z,AP,u(AK,AQ,z,AR),y,AJ,AS);
break;case"overlay":y.parameters=AH;w.push(AR,z,AP,u(AK,AQ,z,AR),y,AJ,AS);break;case"tab":w.push(AR,z,AP,u(AK,AQ,z,AR),AQ,x,AH,AU,AD,AJ,AS,y);break;case"lightbox":w.push(AR,z,AP,u(AK,AQ,z,AR),AQ,AH,AJ,AS);break;case"bubble":case"dialog":if(!AL){AL=400;AO={errorMsg:"No width specified - defaulting to 400",warn:s.ERR_BAD_ARG};}if(!AI){AI=400;AO={errorMsg:"No height specified - defaulting to 400",warn:s.ERR_BAD_ARG};}w.push(AR,z,AP,u(AK,AQ,z,AR),AQ,x,AH,AL,AI,AU,AJ,AS);break;case"hidden":C(AR,z,AP,AK,AQ,x,AH,AF,AD,AJ,AS);break;case"uninstall":C(AR,z,AP,AK,AQ,x,AH,AF,AD,AJ,AA);break;case"messagepane":if(NeoConfig.om.isSandboxEnabled){D(AR,z,AP,AK,AQ,x,AH,AF,AD,AJ,AA);}break;default:AO={error:s.ERR_INVALID_TARGET,errorMsg:"Target '"+AT+"' not supported."};AS();}if(w.length>1){E.use("om-controller-views-other",function(AV){g.handleView.apply(null,w);});}}function p(w,x,AA,Y){U.assert(x==="data"||x==="events");var z;try{z=w.config[x][AA].action;}catch(y){if(Y){z={launch:{view:"full",target_zone:"tab",context:null}};}}return z;}function Z(Y){Y.close();R(Y);Y.destroy();}function a(w){var Y=f.get(w),x=Y&&Y.get("instanceId"),w=Y&&Y.get("viewId");if(!Y||Y.get("closing")){return;}Y.set("closing",true);Z(Y);}function M(w,x){var Y;if(!n.isInDb(w)){if(!x){E.use("common-ui-dialog-helper",function(AA){var z={hd:strings["str_om_error_app_not_found_title"],bd:strings["str_om_error_app_not_found_body"]};function y(){AA.use("om-controller-addremoveapp",function(AB){L.AddRemoveApp.uninstallApp(w.app);});}AA.common.ui.DialogHelper.confirm(z,{ok:{handler:y}});});}return false;}if(n.isRevoked(w)){if(!x){Y={source:"unpublish",noConfirmDialog:true};E.use("common-ui-dialog-helper",function(z){function y(){z.use("om-controller-addremoveapp",function(AA){L.AddRemoveApp.uninstallApp(w.app,Y);});}z.common.ui.DialogHelper.alert({hd:strings["str_om_error_app_nonexistant_title"],bd:strings["str_om_error_app_nonexistant_body"]},{ok:{handler:y}});});}return false;}if(n.isSick(w)){if(!x){E.use("common-ui-dialog-helper",function(y){y.common.ui.DialogHelper.alert({hd:strings["str_om_error_app_unavailable_title"],bd:r(strings["str_om_error_app_unavailable_body"],{app_name:w.label})});});}return false;}return true;}function i(AG,AE,AJ,y,w,Y,AA,AC,z,AD){U.assert(!AA);if(!AG||!AG.config||AG.app=="retry"){E.use("om-controller-applicationlist",function(AN){if(AG.app=="retry"){L.ApplicationList.loadApplication();}else{L.ApplicationList.getApplicationConfigs(function(AO){if(AO){i(n.get(AG.app),AE,AJ,y,w,Y,AA,AC,z,AD);}else{return;}});}});return;}if(!M(AG,AC)){return;}var x={};if(AG.needsAck){t.log("preinstall: "+AG.name);x={callback:function(AN){if(!AN.error){i(n.get(AG.app),AE,AJ,y,w,Y);}},appStatus:AG.status,appName:AG.name,developerName:AG.developer_name,description:AG.description,source:"preinstall"};E.use("om-controller-addremoveapp",function(AN){L.AddRemoveApp.installApp(AG.app,x);});return;}var AB=p(AG,AE,AJ,y),AF,AL,AK,AM,AI,AH=(AE==="data")?"data/message":(AE+"/"+AJ);for(AF in AB){AL=AB[AF];U.assert(AF=="launch");if(!AG.views[AL.view]){E.use("common-ui-dialog-helper",function(AN){AN.common.ui.DialogHelper.alert({hd:strings["str_om_error_app_unavailable_title"],bd:r(strings["str_om_error_app_unavailable_body"],{app_name:AG.label})});});return false;}AI=w;AK=B(AG.app,AJ,AL);AM=(AL.target_zone==="uninstall")?AG.label:(AL.title||AG.label);if(n.isMessenger(AG.app)){E.fire("Y.om.controller:launchIM:start");}E.each(AL.options,function(AP,AO){var AQ=(AP==="true"||AP==="1"),AR=(AP==="false"||AP==="0"),AN=AQ||AR;x[AO]=AN?(AQ||!AR):AP;});q(AG.app,AG.instance,AK,AL.view,AG.views[AL.view].type,AL.target_zone,AL.context,AI||null,AL.width,AL.height,AL.ttl,AM,AH,null,Y,AJ,z,x,AD);}}function o(z,y){var x=f.getAll(),w,Y;for(w in x){Y=x[w];if(z===Y.get("appId")&&y===Y.get("instanceId")&&!Y.get("closing")){a(w);}}E.fire("om:close_application"+y,y);}E.mix(g,{openView:q,closeView:a,closeApplication:o,getInternalViewId:B,getInternalUserViewId:P,getInternalDefaultViewId:h,isOpened:Q,runActions:i},true);},"1.0.0",{requires:["common-utils","om-controller-base","om-common-utils","om-model-datastore","om-controller-crossframe","om-common-errors","querystring-stringify-simple"]});