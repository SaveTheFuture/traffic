YUI.add("pp-globals",function(D){D.namespace("PhotoPreview");var A=D.PhotoPreview,C=D.config.win,B=A.OMAPI||C.openmail;D.mix(A,{OMAPI:B,OMPARAMS:A.OMPARAMS||null,PROTOCOL:(B&&B.Application.isSSL())?"https":"http",CONFIG:{mediaBar:{thumbWidth:72,thumbHeight:72,maxThumbs:6,teaserPercent:0,alignHorzCenter:false,carouselClass:"mediaBar",containerFullWidth:false},filmstrip:{thumbWidth:72,thumbHeight:72,maxThumbs:25,alignHorzCenter:true,carouselClass:"filmstrip",containerFullWidth:true},fetchImageMetadata:32,useConsole:false&&typeof window!=="undefined"}},true);},"@VERSION@");
YUI.add("pp-rocketstats",function(F){F.namespace("PhotoPreview.rocketstats");var C=F.PhotoPreview,B=F.Array,D=C.rocketstats,E=function(J,H){J=F.Lang.isString(J)?[J]:J;H=F.Lang.isString(H)||F.Lang.isNumber(H)?[H]:H||[];var I,G=J?J.length:0,A=[];for(I=0;I<G;I++){A.push({key:("Flixy:"+J[I]),value:H[I]});}B.each(A,function(L){var K={key:L.key};if(L.value>=0){K.value=L.value;}C.OMAPI.Application.callWebService({url:"apps://",method:"GET",parameters:{cmd:"rs",args:K}});});};F.mix(D,{post:E});},"@VERSION@",{requires:["pp-utils","array-extras"]});
YUI.add("pp-runtime",function(B){B.namespace("PhotoPreview");var G=B.PhotoPreview,H=B.Lang,K="popup",I="app.html",E="lightbox",F,A=function(N,L,M){G.openmail.callInternalAPI(N,L,M);},J={"2":{version:2,vidRe:new RegExp("^om_default_view_id_\\S+-message_read$"),messageBody:".msg-body",threadBody:".thread-body",getAttachmentMetas:function(L){return B.Array.map(L,function(N){var M=G.htmlDecode(N.filename);return{partId:N.partId,tnefId:N.tnefId,type:N.type,subtype:N.subtype,filename:M,filesize:N.size,thumbnailUrl:N.thumbnailurl,attachmentUrl:N.url,title:H.trim(M)};});},downloadAttachment:function(L,M,O){var N=H.isObject(L)?L:{partId:L};N.viewId=G.VIEWID;N.msgItem=G.MSGITEM;B.use("pp-openmail",function(P){A("msgAttachmentDownloadSingle",N,O);});},downloadAllImageAttachments:function(L,M){B.use("pp-openmail",function(N){A("msgAttachmentDownloadAllPhotos",{viewId:G.VIEWID,msgItem:G.MSGITEM},M);});},downloadAllOtherAttachments:function(L,M){B.use("pp-openmail",function(N){A("msgAttachmentDownloadAll",{viewId:G.VIEWID,msgItem:G.MSGITEM},M);});},downloadEverything:function(L,M){B.use("pp-openmail",function(N){A("msgAttachmentDownloadEverything",{viewId:G.VIEWID,msgItem:G.MSGITEM},M);});},unblockImages:function(){B.use("pp-openmail",function(L){A("unblockImages",{viewId:G.VIEWID});});},openPopup:function(L,M){B.use("pp-openmail",function(O){L.data.lang=O.config.win.PhotoPreview.Env.CONFIG.uselang||"";var N={id:K,view:I,target:E,title:L.title,parameters:L.data,ttl:0};G.openmail.openView(N,M);});},getAttachmentHandlerInfo:function(L,M,N){B.use("pp-openmail",function(O){A("getAttachmentHandlerInfo",L,function(P){var Q;if(P.status&&P.data){Q=P.data;}N(Q);});});},openAttachmentViewer:function(M,L,N,O){B.use("pp-openmail",function(Q){var P={handlerId:M,attachments:[{partId:L.pid,tnefId:L.tnefId,type:L.origtype,subtype:L.subtype,filename:L.filename,filesize:L.filesize,url:L.url}]};A("openAttachmentViewer",P,O);});},fireEvent:function(M,L){B.use("pp-openmail",function(N){A("event.fire",{event:M,args:L});});}},"1":{version:1,vidRe:new RegExp("^id_default_long_name_unlikely_to_be_used_by_apps_"+"\\S+_hidden_message_read$"),messageBody:"#cg_msg_content"}},D=function(L){F=J[L];if(!F){B.Object.some(J,function(N,M){if(N.vidRe.test(L)){F=N;return true;}return false;});}return F;},C=function(){return F;};G.initRuntime=D;G.getRuntime=C;},"@VERSION@");
YUI.add("pp-utils",function(D){D.namespace("PhotoPreview");var T=D.PhotoPreview,V=D.Array,N=D.Lang,J=D.Object,g=["https://","http://"],b=D.JSON.stringify,G=function(){},U=function(k,L,Y){var A=[],O;Y=Y||1;V.each([[k,"start"],[L,"end"],[Y,"step"]],function(n){var m=n[0],l=n[1];if(!N.isNumber(m)){throw new Error("Unsupported "+l+" value: "+b(m));}});if(Y<1){throw new Error("Unsupported step value: "+Y);}for(O=k;O<L;O+=Y){A.push(O);}return A;},i=function(A,L){return N.isString(A)&&A.substring(0,L.length)===L;},e=function(L,Y){if(N.isString(L)){var O=L.length,A=Y.length;return O>=A&&L.substring(O-A)===Y;}return false;},B=function(A){return A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\\/g,"&#92;").replace(/&(?:amp;)+/g,"&amp;");},K=function(A){return A.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#92;/g,"\\");},C=function(A){var L=V.map(J.keys(A),function(O){var Y=A[O];return[O,'="',Y,'"'].join("");}).join(" ");return L?[" ",L].join(""):"";},d=function(A){return V.map(J.keys(A),function(L){var O=A[L];return["<param",C({name:L,value:O}),">","</param>"].join("");}).join("");},R=function(A){var L;if(i(A,g[0])){L=g[0];}else{if(i(A,g[1])){L=g[1];}}return L;},S=function(A){return !N.isUndefined(R(A));},h=function(A){var Y=R(A).length,l=A.substring(Y),O=l.indexOf("/"),L=O>=0?O:l.length,k=l.substring(0,L).split("#")[0].split("?")[0];return k;},j=function(A){var O=R(A).length,Y=A.substring(O),L=Y.indexOf("/");return Y.substring(L>=0?L:Y.length).split("#")[0].split("?")[0].replace(/\/+/g,"/").replace(/\/$/,"");},I=function(A){var L=A.substring(1);return L?L.split("/"):[];},M=function(A){return I(j(A));},W=function(A){return V.reduce(A.split("&"),{},function(L,O){var l=O.split("="),Y=decodeURIComponent(l[0]),k=l[1];if(Y){L[Y]=k&&k.length>0?decodeURIComponent(k):null;}return L;});},F=function(A){var L=(A.split("?")[1]||"").split("#")[0];return W(L);},Q=function(A){var L=(A.split("#")[1]||"").split("?")[0];return L;},H={info:0,warn:1,error:2},Z=function(A,O,L){return function(){};},a=function(Y,k,L){var O=H[k||"info"],A={};J.each(H,function(m,l){A[l]=m>=O?Z(l,Y,L):G;});return A;},f=function(k,Y,O){var n,A,m,L,l;if(!D.UA.chrome){n=V.find(["fileName","sourceURL"],function(o){return Y[o];});A=V.find(["lineNumber","line"],function(o){return Y[o];});m=Y[n]?[Y[n].replace(/^.*\//,""),":",Y[A]].join(""):null;L=[];if(O){L.push(O);}if(m){L.push([m,Y.toString()].join(": "));}if(L.length===0||!Y.stack){L.push(b(Y));}if(L.length>0){k.error(L.join("\n"));}}if(N.isString(Y.stack)){l=V.map(Y.stack.split("\n"),function(o){o=o.replace(/^.*@/,"").replace(/\D+$/,"");if(o.search("[?&]")<0){return o.replace(/^.*\//,"");}return o.replace(/^.*(?=http)/mg,"");});k.error(l.join("\n"));}},P=function(O,L,A){f(O,L,A);throw L;},X=T.CONFIG.useConsole?function(O,L,A){D.use("console","console-filters","dd-plugin","node",function(o){try{var m=o.one("body"),l=m.one(".yui3-console"),k;A=o.merge({newestOnTop:false,width:"400px",height:"400px",node:undefined},A);if(!l){m.addClass("yui3-skin-sam");k=new o.Console(A).plug(o.Plugin.Drag,{handles:[".yui3-console-hd"]}).plug(o.Plugin.ConsoleFilters,{}).render(A.node);}if(N.isFunction(O)){O(o);}}catch(n){P(L,n);}});}:function(Y,O,A){try{if(N.isFunction(Y)){Y(D);}}catch(L){P(O,L);}},E,c=function(A,O){try{var L=T.OMPARAMS.user.themeinfo,k=L.css,l=false;L.css=A.css||"";L.name=A.name||"";l=(L.css!=k);if(l||O){D.Get.css(L.css,{onSuccess:function(n){var m=E;setTimeout(function(){if(m&&m.purge){m.purge();}E=n;},600);}});}}catch(Y){}};D.mix(T,{range:U,startsWith:i,endsWith:e,htmlEncode:B,htmlDecode:K,htmlAttrs:C,htmlObjectParams:d,isUrl:S,urlHost:h,urlPath:j,pathV:I,urlPathV:M,dictUrlQueryParams:W,urlQueryParams:F,urlHash:Q,createLogger:a,logError:f,handleError:P,useLogConsole:X,updateTheme:c});},"@VERSION@",{requires:["pp-globals","json-stringify","array-extras"]});
